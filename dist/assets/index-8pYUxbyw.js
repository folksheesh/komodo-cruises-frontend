import{r as Xe,c as v,o as c,a as e,b as we,d as R,w as Ne,e as F,f as ts,n as V,t as d,g,h as M,i as Ft,j as vt,k as Rs,T as Fs,l as Bs,F as W,m as ie,p as z,v as Ke,q as qe,s as qs,u as ss,x as ve,y as Gs,z as Ge,A as Ls,B as rt,C as es,D as Us,E as zs,G as Vs,H as Js}from"./vendor-BlvJPNTT.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))S(f);new MutationObserver(f=>{for(const C of f)if(C.type==="childList")for(const m of C.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&S(m)}).observe(document,{childList:!0,subtree:!0});function p(f){const C={};return f.integrity&&(C.integrity=f.integrity),f.referrerPolicy&&(C.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?C.credentials="include":f.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function S(f){if(f.ep)return;f.ep=!0;const C=p(f);fetch(f.href,C)}})();const pt=(k,i)=>{const p=k.__vccOpts||k;for(const[S,f]of i)p[S]=f;return p},Ys={},Ks={key:0,class:"nav-inner"},Ws={key:1,class:"nav-inner"},Hs={class:"nav-right"},js={key:2,class:"nav-inner"},Qs={class:"nav-right"},Xs={class:"nav-search"},Zs={width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",style:{"vertical-align":"middle","margin-right":"4px"}},ea={class:"nav-menu"},ta={width:"28",height:"28",viewBox:"0 0 28 28",fill:"currentColor",style:{"vertical-align":"middle","margin-left":"6px"}},sa={key:0,class:"site-footer mt-16"},aa={class:"footer-inner container text-sm"};function oa(k,i){const p=Xe("router-link"),S=Xe("router-view");return c(),v("div",null,[e("header",{class:V(["nav-container",{"nav-overlay":k.$route.path==="/","home-nav":k.$route.path==="/"}])},[k.$route.meta.planHeader?(c(),v("nav",Ks,[i[1]||(i[1]=e("div",{style:{display:"flex","align-items":"center",gap:".75rem",color:"var(--ocean-900)"}},[e("div",{class:"brand"},"Plan your trip")],-1)),we(p,{class:"link-close",to:"/"},{default:Ne(()=>[...i[0]||(i[0]=[F("Close ✕",-1)])]),_:1})])):k.$route.path==="/results"?(c(),v("nav",Ws,[i[3]||(i[3]=e("div",{class:"nav-left"},[e("span",{class:"brand-text"},"Komodo Cruises")],-1)),e("div",Hs,[we(p,{to:"/",class:"back-link"},{default:Ne(()=>[...i[2]||(i[2]=[F("‹ Back to komodocruises.com",-1)])]),_:1})])])):(c(),v("nav",js,[i[9]||(i[9]=e("div",{class:"nav-left"},[e("span",{class:"brand-chip"},"Komodo Cruises")],-1)),e("div",Qs,[k.$route.path!=="/"?(c(),ts(p,{key:0,to:"/plan",class:"btn-plan"},{default:Ne(()=>[...i[4]||(i[4]=[F("Plan your trip",-1)])]),_:1})):R("",!0),e("span",Xs,[(c(),v("svg",Zs,[...i[5]||(i[5]=[e("circle",{cx:"9",cy:"9",r:"7",stroke:"currentColor","stroke-width":"2"},null,-1),e("line",{x1:"15.2",y1:"15.2",x2:"19",y2:"19",stroke:"currentColor","stroke-width":"2"},null,-1)])])),i[6]||(i[6]=e("span",{class:"nav-label"},"Search",-1))]),e("span",ea,[i[8]||(i[8]=e("span",{class:"nav-label"},"Menu",-1)),(c(),v("svg",ta,[...i[7]||(i[7]=[e("rect",{y:"6",width:"28",height:"3",rx:"1.5"},null,-1),e("rect",{y:"13",width:"28",height:"3",rx:"1.5"},null,-1),e("rect",{y:"20",width:"28",height:"3",rx:"1.5"},null,-1)])]))])])]))],2),we(S),!k.$route.meta.planHeader&&k.$route.path!=="/"?(c(),v("footer",sa,[e("div",aa,"© "+d(new Date().getFullYear())+" Komodo Cruises",1)])):R("",!0)])}const na=pt(Ys,[["render",oa]]),Pt=""+new URL("komodo-BowhS1uY.jpg",import.meta.url).href,la="https://script.google.com/macros/s/AKfycbwvfIHPdbGq7cVlbX6g1IPoBdE2xIqYD9fZJclMlq9AYAFGa--e3eGV15HbYfrj2z4vLw/exec";function Bt(k){const i=new URL(la),p=new URLSearchParams;for(const[S,f]of Object.entries(k))f!==void 0&&p.set(S,f);return i.search=p.toString(),i.toString()}async function qt(k){if(!k.ok)throw new Error(`HTTP ${k.status}: ${k.statusText}`);const i=await k.json();if((i==null?void 0:i.ok)===!1)throw new Error(i.error||"API error");return i}const Mt=new Map,It=new Map,Qe=new Map;let Et=null;async function as(){if(Et)return Et;const k=Bt({resource:"operators"}),i=await fetch(k),p=await qt(i);return Et=p,p}async function Ot(k){const i=`cabins|${k||""}`;if(Mt.has(i))return Mt.get(i);const p=Bt({resource:"cabins",sheet:k}),S=await fetch(p),f=await qt(S);return Mt.set(i,f),f}async function ut(k,i){if(!/^\d{4}-\d{2}-\d{2}$/.test(k))throw new Error("Date must be in YYYY-MM-DD format");const p=`${k}|${i||""}`;if(It.has(p))return It.get(p);if(Qe.has(p))return Qe.get(p);const S=Bt({resource:"availability",date:k,sheet:i}),f=fetch(S).then(C=>qt(C)).then(C=>(It.set(p,C),Qe.delete(p),C)).catch(C=>{throw Qe.delete(p),C});return Qe.set(p,f),f}function Gt(k){const i=k.getFullYear(),p=String(k.getMonth()+1).padStart(2,"0"),S=String(k.getDate()).padStart(2,"0");return`${i}-${p}-${S}`}function ia(k){return new Date(k+"T00:00:00")}function ra(k,i){const p=ia(k);return p.setDate(p.getDate()+i),Gt(p)}function ua(){return Gt(new Date)}const da={key:0,class:"modal-overlay"},ca={class:"modal-container"},va={class:"modal-body"},pa={class:"plan-wrap plan-page"},ma={class:"plan-content"},ya={class:"steps",role:"tablist","aria-label":"Plan steps"},fa=["disabled"],ga=["disabled"],ba=["disabled"],ha=["disabled"],ka={key:0},wa={class:"list"},_a={class:"list-text"},Ca=["value","aria-label"],$a={key:1},Sa={class:"list"},Da={key:0,class:"muted"},xa={class:"list-text"},Na=["value","aria-label"],Aa={key:0,class:"muted"},Ta={key:2},Pa={class:"date-input-section"},Ma=["min"],Ia={class:"custom-calendar"},Ea={class:"calendar-header"},Oa={class:"calendar-title"},Ra={class:"calendar-grid"},Fa={class:"calendar-days"},Ba=["disabled","onClick"],qa={key:3},Ga={class:"counters"},La={class:"counter-row"},Ua={class:"counter-ctrls"},za={class:"count"},Va={class:"counter-row"},Ja={class:"counter-ctrls"},Ya={class:"count"},Ka={class:"counter-row"},Wa={class:"counter-ctrls"},Ha={class:"count"},ja={class:"counter-row"},Qa={class:"counter-ctrls"},Xa={class:"count"},Za={key:4},eo={class:"bottom-bar"},to={class:"nav-inner",style:{display:"flex","align-items":"center","justify-content":"space-between"}},so={key:1},ao="Nusa Tenggara Timur",oo={__name:"PlanModal",props:{isOpen:Boolean},emits:["close","navigate-to-results"],setup(k,{emit:i}){const p=k,S=i,f=g(1),C=["Komodo National Park","Labuan Bajo"],m=[],A=g([]),h=g(!1),O=g([]),Y=g([]),K=g(""),I=g(""),B=g(2),q=g(0),pe=g(0),G=g(0),re=g(new Date().getMonth()),Ie=g(new Date().getFullYear()),_e=["Destinations","Ships","Dates","Guests","Submit"],Le=M(()=>_e[f.value-2]||""),se=M(()=>f.value<5?_e[f.value-1]+" ›":"Submit ›"),ue=M(()=>ua()),be=M(()=>`${["January","February","March","April","May","June","July","August","September","October","November","December"][re.value]} ${Ie.value}`),L=M(()=>{const $=new Date(Ie.value,re.value,1),n=new Date(Ie.value,re.value+1,0),_=new Date($),U=new Date;_.setDate(_.getDate()-_.getDay());const ee=[],Se=new Date(n);Se.setDate(Se.getDate()+(6-n.getDay()));for(let de=new Date(_);de<=Se;de.setDate(de.getDate()+1)){const Je=de.getDay(),We=de.getMonth()===re.value,mt=We&&de>=U&&(Je===1||Je===5),et=Gt(de);ee.push({key:de.getTime(),date:de.getDate(),fullDate:et,isCurrentMonth:We,isSelectable:mt,isSelected:K.value===et,isMonday:Je===1,isFriday:Je===5})}return ee}),Ue=M(()=>O.value.length>0),ze=M(()=>O.value.length>0&&Y.value.length>0),Ce=M(()=>O.value.length>0&&Y.value.length>0&&!!K.value);Ft(O,()=>{Y.value=[]});const H={bodyOverflow:"",htmlOverflow:"",bodyPadding:"",htmlPadding:""};Ft(()=>p.isOpen,$=>{$?me():Ae()},{immediate:!0}),vt(()=>{D()}),Rs(()=>{Ae()});function ae(){S("close")}function $e($){f.value=$}function j(){if(f.value===1&&O.value.length===0)return Re("Please select at least one destination first.");if(f.value===2&&Y.value.length===0)return Re("Please select at least one ship first.");if(f.value===3&&!K.value)return Re("Please select a start date first.");f.value<5?f.value++:Z()}function Q(){f.value>1&&f.value--}function N(){Z()}function l(){Z()}function Z(){const $=A.value.filter(ee=>Y.value.includes(ee.id)),n=$.map(ee=>ee.label),_=$.map(ee=>ee.sheet),U={region:ao,destination:O.value[0]||"",destinations:O.value.slice(),ships:n,shipSheets:_,ship:n[0]||"",lodges:n.slice(),dateFrom:K.value,dateTo:I.value,adults:B.value,children:q.value,age3_9:pe.value,age0_2:G.value,totalGuests:B.value+q.value+pe.value+G.value,timestamp:Date.now()};localStorage.setItem("komodo_search_criteria",JSON.stringify(U)),S("navigate-to-results")}async function D(){h.value=!0;try{const n=((await as()).operators||[]).map(_=>{var Se,de;const U=((Se=_.operator)==null?void 0:Se.trim())||"",ee=((de=_.sourceSheet)==null?void 0:de.trim())||U;return{id:`${U}__${ee}`,label:U,sheet:ee}}).filter(_=>_.label&&_.sheet);A.value=n.length?n:oe(m)}catch($){console.warn("Failed to load operators:",$),A.value=oe(m)}finally{h.value=!1}}function me(){const $=document.body,n=document.documentElement;if(!$||!n)return;const _=window.innerWidth-n.clientWidth;if(H.bodyOverflow=$.style.overflow,H.htmlOverflow=n.style.overflow,H.bodyPadding=$.style.paddingRight,H.htmlPadding=n.style.paddingRight,_>0){const U=`${_}px`;$.style.paddingRight=U,n.style.paddingRight=U}$.style.overflow="hidden",n.style.overflow="hidden"}function Ae(){const $=document.body,n=document.documentElement;!$||!n||($.style.overflow=H.bodyOverflow,n.style.overflow=H.htmlOverflow,$.style.paddingRight=H.bodyPadding,n.style.paddingRight=H.htmlPadding)}function oe($){return Array.isArray($)?$.map(n=>{var ee,Se;const _=((ee=n.label)==null?void 0:ee.trim())||"",U=((Se=n.sheet)==null?void 0:Se.trim())||_;return{id:n.id||`${_}__${U}`,label:_,sheet:U}}).filter(n=>n.label&&n.sheet):[]}function he($){$==="adults"?B.value++:$==="children"?q.value++:$==="age3_9"?pe.value++:$==="age0_2"&&G.value++}function Te($){$==="adults"&&B.value>0?B.value--:$==="children"&&q.value>0?q.value--:$==="age3_9"&&pe.value>0?pe.value--:$==="age0_2"&&G.value>0&&G.value--}function Re($){alert($)}function ye(){re.value===0?(re.value=11,Ie.value--):re.value--}function Ee(){re.value===11?(re.value=0,Ie.value++):re.value++}function Ze($){$.isSelectable&&(K.value=$.fullDate,I.value=ra($.fullDate,3))}return($,n)=>(c(),ts(Bs,{to:"body"},[we(Fs,{name:"modal-fade"},{default:Ne(()=>[k.isOpen?(c(),v("div",da,[e("div",ca,[e("div",{class:"modal-header"},[e("div",{class:"modal-header-content"},[n[16]||(n[16]=e("h2",{class:"modal-title"},"Plan your trip",-1)),e("button",{class:"modal-close",onClick:ae},"Close ✕")])]),e("div",va,[e("section",pa,[e("div",ma,[e("div",ya,[e("button",{class:V(["step",{"step-active":f.value===1}]),onClick:n[0]||(n[0]=_=>$e(1))},"Step 1",2),e("button",{class:V(["step",{"step-active":f.value===2}]),onClick:n[1]||(n[1]=_=>$e(2)),disabled:!Ue.value},"Step 2",10,fa),e("button",{class:V(["step",{"step-active":f.value===3}]),onClick:n[2]||(n[2]=_=>$e(3)),disabled:!ze.value},"Step 3",10,ga),e("button",{class:V(["step",{"step-active":f.value===4}]),onClick:n[3]||(n[3]=_=>$e(4)),disabled:!Ce.value},"Step 4",10,ba),e("button",{class:V(["step",{"step-active":f.value===5}]),onClick:n[4]||(n[4]=_=>$e(5)),disabled:!Ce.value},"Step 5",10,ha)]),f.value===1?(c(),v("div",ka,[n[18]||(n[18]=e("h3",{class:"step-title"},"Destinations",-1)),n[19]||(n[19]=e("p",{class:"results-note"},"Select the destinations you're interested in:",-1)),e("div",wa,[n[17]||(n[17]=e("div",{class:"list-heading"},"Nusa Tenggara Timur",-1)),(c(),v(W,null,ie(C,_=>e("div",{class:"list-row",key:_},[e("div",_a,d(_),1),z(e("input",{class:"check",type:"checkbox",value:_,"onUpdate:modelValue":n[5]||(n[5]=U=>O.value=U),"aria-label":`Destination ${_}`},null,8,Ca),[[Ke,O.value]])])),64))])])):f.value===2?(c(),v("div",$a,[n[21]||(n[21]=e("h3",{class:"step-title"},"Ships",-1)),n[22]||(n[22]=e("p",{class:"results-note"},"Please select one or more ships:",-1)),e("div",Sa,[n[20]||(n[20]=e("div",{class:"list-heading"},"Available Ships",-1)),h.value?(c(),v("div",Da,"Loading ships...")):(c(),v(W,{key:1},[(c(!0),v(W,null,ie(A.value,_=>(c(),v("div",{class:"list-row",key:_.id},[e("div",xa,d(_.label),1),z(e("input",{class:"check",type:"checkbox",value:_.id,"onUpdate:modelValue":n[6]||(n[6]=U=>Y.value=U),"aria-label":`Ship ${_.label}`},null,8,Na),[[Ke,Y.value]])]))),128)),A.value.length===0?(c(),v("div",Aa,"No ships found from API.")):R("",!0)],64))])])):f.value===3?(c(),v("div",Ta,[n[25]||(n[25]=e("h3",{class:"step-title"},"Dates",-1)),n[26]||(n[26]=e("p",{class:"results-note"},"Select the start date for your trip:",-1)),n[27]||(n[27]=e("p",{class:"results-note text-sm"},"Trips start only on Mondays and Fridays.",-1)),e("div",Pa,[n[23]||(n[23]=e("label",{class:"date-label"},"Start Date:",-1)),z(e("input",{type:"text",disabled:"",class:"input date-input","onUpdate:modelValue":n[7]||(n[7]=_=>K.value=_),min:ue.value},null,8,Ma),[[qe,K.value]])]),e("div",Ia,[e("div",Ea,[e("button",{class:"calendar-nav",onClick:ye,type:"button"},"‹"),e("h4",Oa,d(be.value),1),e("button",{class:"calendar-nav",onClick:Ee,type:"button"},"›")]),e("div",Ra,[n[24]||(n[24]=e("div",{class:"calendar-weekdays"},[e("div",{class:"weekday"},"Su"),e("div",{class:"weekday"},"Mo"),e("div",{class:"weekday"},"Tu"),e("div",{class:"weekday"},"We"),e("div",{class:"weekday"},"Th"),e("div",{class:"weekday"},"Fr"),e("div",{class:"weekday"},"Sa")],-1)),e("div",Fa,[(c(!0),v(W,null,ie(L.value,_=>(c(),v("button",{key:_.key,class:V(["calendar-day",{"other-month":!_.isCurrentMonth,selected:_.isSelected,disabled:!_.isSelectable,monday:_.isMonday,friday:_.isFriday}]),disabled:!_.isSelectable,onClick:U=>Ze(_),type:"button"},d(_.date),11,Ba))),128))])])])])):f.value===4?(c(),v("div",qa,[n[32]||(n[32]=e("h3",{class:"step-title"},"Guests",-1)),n[33]||(n[33]=e("p",{class:"results-note"},"Please indicate how many adults will need to be accommodated.",-1)),n[34]||(n[34]=e("p",{class:"results-note"},"If your booking includes children, please enquire directly on the next step.",-1)),n[35]||(n[35]=e("p",{class:"results-note"},"View our child policy for each lodge here.",-1)),e("div",Ga,[e("div",La,[n[28]||(n[28]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Adults"),e("div",{class:"muted text-sm"},"Ages 17+")],-1)),e("div",Ua,[e("button",{type:"button",class:"btn-icon",onClick:n[8]||(n[8]=_=>Te("adults"))},"−"),e("span",za,d(B.value),1),e("button",{type:"button",class:"btn-icon",onClick:n[9]||(n[9]=_=>he("adults"))},"+")])]),e("div",Va,[n[29]||(n[29]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Children"),e("div",{class:"muted text-sm"},"Ages 10 - 16")],-1)),e("div",Ja,[e("button",{type:"button",class:"btn-icon",onClick:n[10]||(n[10]=_=>Te("children"))},"−"),e("span",Ya,d(q.value),1),e("button",{type:"button",class:"btn-icon",onClick:n[11]||(n[11]=_=>he("children"))},"+")])]),e("div",Ka,[n[30]||(n[30]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Ages 3 - 9")],-1)),e("div",Wa,[e("button",{type:"button",class:"btn-icon",onClick:n[12]||(n[12]=_=>Te("age3_9"))},"−"),e("span",Ha,d(pe.value),1),e("button",{type:"button",class:"btn-icon",onClick:n[13]||(n[13]=_=>he("age3_9"))},"+")])]),e("div",ja,[n[31]||(n[31]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Ages 0 - 2")],-1)),e("div",Qa,[e("button",{type:"button",class:"btn-icon",onClick:n[14]||(n[14]=_=>Te("age0_2"))},"−"),e("span",Xa,d(G.value),1),e("button",{type:"button",class:"btn-icon",onClick:n[15]||(n[15]=_=>he("age0_2"))},"+")])])])])):(c(),v("div",Za,[n[36]||(n[36]=e("h3",{class:"step-title"},"Check Availability",-1)),n[37]||(n[37]=e("p",{class:"results-note"}," To see if we have availability for your preferred criteria, please click the button below. ",-1)),e("div",{class:"mt-4"},[e("button",{class:"btn-primary",onClick:N},"Check now")]),n[38]||(n[38]=e("div",{class:"section-divider",style:{margin:"1.5rem 0"}},null,-1)),n[39]||(n[39]=e("h4",{class:"section-title"},"Speak with a Komodo Cruises Travel Advisor",-1)),n[40]||(n[40]=e("p",{class:"results-note"}," Need some help to plan your trip? Enquire below to contact one of our Komodo Cruises Travel Advisors. ",-1)),e("div",{class:"mt-4"},[e("button",{class:"btn-primary",onClick:l},"Enquire now")])])),e("div",eo,[e("div",to,[f.value>1?(c(),v("button",{key:0,class:"link-muted",onClick:Q},"‹ "+d(Le.value),1)):(c(),v("span",so)),e("button",{class:"btn-primary",onClick:j},d(se.value),1)])])])])])])])):R("",!0)]),_:1})]))}},no=pt(oo,[["__scopeId","data-v-b3412e6e"]]),lo={class:"home-footer"},io={class:"home-footer-inner container"},ro={class:"hf-links"},uo={class:"hf-meta"},co={__name:"Home",setup(k){const i=Gs(),p=g(!1);let S;function f(){p.value=!0}function C(){p.value=!1}function m(){p.value=!1,i.push("/results")}return vt(async()=>{await qs();const A=Array.from(document.querySelectorAll(".reveal"));A.length&&(S=new IntersectionObserver(h=>{h.forEach(O=>{O.isIntersecting&&(O.target.classList.add("revealed"),S==null||S.unobserve(O.target))})},{threshold:.2}),A.forEach(h=>S.observe(h)))}),ss(()=>{S==null||S.disconnect()}),(A,h)=>(c(),v(W,null,[e("section",{class:"hero-section"},[e("div",null,[h[0]||(h[0]=e("h1",{class:"hero-title"},"Shores of Wonder",-1)),h[1]||(h[1]=e("p",{class:"hero-sub"},"Embark on an exclusive voyage through the Komodo Islands.",-1)),e("button",{class:"hero-cta",onClick:f},"Plan your trip")])]),e("section",{class:"story-section"},[e("div",{class:"story-grid container"},[h[5]||(h[5]=e("div",{class:"story-media reveal"},[e("img",{src:Pt,alt:"Komodo landscape",loading:"lazy"})],-1)),e("div",{class:"story-copy reveal"},[h[2]||(h[2]=e("p",{class:"eyebrow"},"A story unfolds",-1)),h[3]||(h[3]=e("h2",{class:"story-title"},"Journeys shaped by the Komodo Islands",-1)),h[4]||(h[4]=e("p",{class:"story-text"},"From quiet sunrises over pink shores to manta-filled seas, our voyages are crafted to reveal the soul of this archipelago with care and purpose.",-1)),e("button",{class:"story-cta",onClick:f},"Our story")])])]),e("section",{class:"story-section alt"},[e("div",{class:"story-grid reverse container"},[h[9]||(h[9]=e("div",{class:"story-media reveal"},[e("img",{src:Pt,alt:"Dive with mantas",loading:"lazy"})],-1)),e("div",{class:"story-copy reveal"},[h[6]||(h[6]=e("p",{class:"eyebrow"},"Crafted voyages",-1)),h[7]||(h[7]=e("h2",{class:"story-title"},"Sail, dive, and wander across wild horizons",-1)),h[8]||(h[8]=e("p",{class:"story-text"},"Every itinerary balances unhurried exploration with effortless comfort—private landings, expert guides, and moments designed to feel both rare and personal.",-1)),e("button",{class:"story-cta",onClick:f},"View experiences")])])]),e("section",{class:"story-section"},[e("div",{class:"story-grid container"},[h[13]||(h[13]=e("div",{class:"story-media reveal"},[e("img",{src:Pt,alt:"Conservation in Komodo",loading:"lazy"})],-1)),e("div",{class:"story-copy reveal"},[h[10]||(h[10]=e("p",{class:"eyebrow"},"Stewardship",-1)),h[11]||(h[11]=e("h2",{class:"story-title"},"Travel that protects what makes this place extraordinary",-1)),h[12]||(h[12]=e("p",{class:"story-text"},"We partner with local communities and conservation programs so your journey supports education, marine research, and livelihoods across the islands.",-1)),e("button",{class:"story-cta",onClick:f},"Our commitment")])])]),e("footer",lo,[e("div",io,[h[18]||(h[18]=e("div",{class:"hf-brand"},[e("div",{class:"hf-logo"},"Komodo Cruises"),e("div",{class:"hf-copy"},"Rare journeys across the Komodo Islands.")],-1)),e("nav",ro,[e("a",{href:"#",onClick:ve(f,["prevent"])},"Plan your trip"),h[14]||(h[14]=e("a",{href:"#"},"Experiences",-1)),h[15]||(h[15]=e("a",{href:"#"},"Our story",-1)),h[16]||(h[16]=e("a",{href:"#"},"Contact",-1))]),e("div",uo,[e("div",null,"© "+d(new Date().getFullYear())+" Komodo Cruises",1),h[17]||(h[17]=e("div",{class:"hf-small"},"All voyages subject to weather and park regulations.",-1))])])]),we(no,{isOpen:p.value,onClose:C,onNavigateToResults:m},null,8,["isOpen"])],64))}},vo="https://komodo-cruises-production-0c52.up.railway.app";async function po(k){try{const i=await fetch(`${vo}/api/create-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:k.amount,payerEmail:k.payerEmail,description:k.description,customerName:k.customerName,customerPhone:k.customerPhone,items:k.items,successRedirectUrl:k.successRedirectUrl||`${window.location.origin}/payment-success`,failureRedirectUrl:k.failureRedirectUrl||`${window.location.origin}/payment-failed`})}),p=await i.json();if(!i.ok)throw new Error(p.message||"Failed to create invoice");return p}catch(i){throw console.error("Error creating Xendit invoice:",i),i}}function mo(k){if(k)window.location.href=k;else throw new Error("Invoice URL is required")}function yo(k){if(!k)return 0;if(typeof k=="number")return k;const i=String(k).replace(/[^\d.,]/g,"").replace(/\./g,"").replace(/,/g,"");return parseInt(i)||0}const fo={class:"results-wrap"},go={class:"results-container"},bo={class:"results-layout"},ho={class:"results-main"},ko={key:0,class:"loading-state"},wo={key:1,class:"error-state"},_o={class:"error-message"},Co={key:2},$o={class:"results-intro"},So={key:0,class:"success-message"},Do={key:1,class:"no-availability"},xo={key:0,class:"lodge-results"},No={class:"cabin-image"},Ao=["src","alt","onError"],To=["onClick"],Po=["onClick"],Mo={class:"cabin-content"},Io={class:"cabin-header"},Eo={class:"cabin-title-group"},Oo={class:"cabin-name"},Ro={class:"cabin-location-row"},Fo={class:"cabin-location"},Bo=["onClick"],qo={class:"cabin-info-section"},Go={class:"cabin-info-left"},Lo={class:"suite-price"},Uo={class:"suite-availability"},zo={class:"cabin-info-right"},Vo=["onClick"],Jo={class:"btn-text"},Yo={class:"btn-icon"},Ko={key:0,class:"icon-x"},Wo={key:1,class:"icon-circle"},Ho={key:1,class:"availability-alternative",style:{"margin-bottom":"1rem"}},jo={key:2,class:"lodge-results"},Qo={class:"lodge-gallery"},Xo={class:"lodge-image"},Zo=["src","alt","onError"],en=["onClick"],tn=["onClick"],sn={class:"lodge-info"},an={class:"lodge-header",style:{display:"flex","align-items":"flex-start","justify-content":"space-between",gap:"1rem"}},on={class:"lodge-name",style:{margin:"0"}},nn={class:"lodge-location",style:{margin:".25rem 0 0"}},ln={class:"suites-info"},rn={class:"availability-count",style:{margin:".25rem 0 1rem"}},un={key:3,class:"lodge-results"},dn={class:"lodge-gallery"},cn={class:"lodge-image"},vn=["src","alt","onError"],pn=["onClick"],mn=["onClick"],yn={class:"lodge-info"},fn={class:"lodge-header",style:{display:"flex","align-items":"flex-start","justify-content":"space-between",gap:"1rem"}},gn={class:"lodge-name",style:{margin:"0"}},bn={class:"lodge-location",style:{margin:".25rem 0 0"}},hn={key:0,class:"availability-success"},kn={key:1,class:"availability-alternative"},wn={class:"suites-info"},_n={class:"suites-header",style:{display:"flex","align-items":"center","justify-content":"space-between"}},Cn={class:"price-from"},$n={class:"availability-count",style:{margin:".25rem 0 1rem"}},Sn={key:4,class:"no-results"},Dn={class:"sidebar-container"},xn={class:"sidebar-section check-availability-section"},Nn=["aria-expanded"],An={class:"caret"},Tn=["src"],Pn=["onClick"],Mn={class:"list-text"},In=["value"],En=["aria-expanded"],On={class:"caret"},Rn=["src"],Fn={class:"dropdown-group-title"},Bn={key:0,class:"muted"},qn=["onClick"],Gn={class:"list-text"},Ln=["value"],Un={key:0,class:"muted"},zn=["aria-expanded"],Vn={class:"caret"},Jn=["src"],Yn={class:"simple-guests"},Kn={class:"simple-guests-ctrls"},Wn={class:"count"},Hn=["aria-expanded"],jn={class:"caret"},Qn=["src"],Xn={class:"date-input-section"},Zn=["value"],el={class:"custom-calendar"},tl={class:"calendar-header"},sl={class:"calendar-title"},al={class:"calendar-grid"},ol={class:"calendar-days"},nl=["disabled","onClick"],ll={class:"sidebar-alt",style:{display:"flex","align-items":"center","justify-content":"space-between",gap:".75rem","margin-top":".75rem"}},il=["aria-pressed"],rl={class:"itinerary-sidebar"},ul={key:0,class:"itinerary-empty"},dl={key:1,class:"itinerary-list"},cl={class:"itinerary-item-header"},vl={class:"itinerary-lodge-name"},pl=["onClick"],ml={class:"itinerary-cabin-name"},yl={class:"itinerary-guests"},fl={class:"itinerary-price"},gl={class:"itinerary-dates"},bl={key:2,class:"itinerary-total"},hl={class:"itinerary-total-row"},kl={class:"itinerary-total-amount"},wl={class:"itinerary-total-note"},_l={key:0,class:"itinerary-total-note"},Cl={key:3,class:"itinerary-total-note"},$l={class:"modal-body"},Sl={class:"modal-image-section"},Dl=["src","alt"],xl={class:"modal-info-section"},Nl={class:"modal-cabin-name"},Al={class:"modal-cabin-meta"},Tl={class:"modal-meta-item"},Pl={class:"modal-meta-item"},Ml={class:"modal-meta-item"},Il={class:"modal-description"},El={class:"modal-amenities"},Ol={key:1,class:"amenity-item"},Rl={class:"modal-rate-section"},Fl={class:"modal-rate-details"},Bl={class:"modal-rate-info"},ql={class:"cabin-quantity-selector"},Gl={class:"quantity-controls"},Ll=["disabled"],Ul={class:"quantity-value"},zl=["disabled"],Vl={class:"quantity-available"},Jl={class:"modal-price"},Yl={class:"price-amount"},Kl={key:0,class:"price-label"},Wl={key:1,class:"price-note"},Hl={class:"guest-modal-body"},jl={class:"guest-counter-section"},Ql={class:"guest-counter-row"},Xl={class:"guest-counter-controls"},Zl=["disabled"],ei={class:"guest-counter-value"},ti=["disabled"],si={class:"guest-available-note"},ai={key:0},oi={key:2,class:"enquiry-modal-overlay"},ni={class:"enquiry-modal-content"},li={class:"enquiry-modal-body"},ii={class:"enquiry-form-section"},ri={class:"form-row"},ui={class:"form-group form-group-small"},di={class:"form-group"},ci={class:"form-group"},vi={class:"form-row"},pi={class:"form-group"},mi={class:"phone-input"},yi={class:"form-group"},fi={class:"form-row"},gi={class:"form-group"},bi={class:"form-group"},hi={class:"form-group"},ki={class:"form-group"},wi={class:"form-checkboxes"},_i={class:"checkbox-label"},Ci={class:"checkbox-label"},$i=["disabled"],Si={class:"enquiry-summary-section"},Di={class:"summary-items"},xi={class:"summary-item-header"},Ni={class:"summary-lodge-name"},Ai={class:"summary-item-details"},Ti={class:"summary-cabin"},Pi={class:"summary-guests"},Mi={class:"summary-dates"},Ii={key:0,class:"summary-pricing"},Ei={class:"pricing-row"},Oi={class:"pricing-value"},Ri={class:"pricing-row"},Fi={class:"pricing-label"},Bi={class:"pricing-value"},qi={key:0,class:"enquiry-total-section"},Gi={class:"enquiry-total"},Li={class:"enquiry-total-row"},Ui={class:"enquiry-total-amount"},zi={key:1,class:"enquiry-pricing-note"},Ve="Rp",dt='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>',ct='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>',Vi='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>',Rt="Nusa Tenggara Timur",Ji={__name:"Results",setup(k){const i=g(!1),p=g(""),S=g(null),f=g({}),C=g([]),m=g(null),A=g([]),h=g(null),O=g(!1),Y=g(!1),K=g(!1),I=g(null),B=g(1),q=g(2),pe=g(!1),G=g(!0),re=["Komodo National Park","Labuan Bajo"],Ie=[],_e=g([]),Le=g(!1),se=g([]),ue=g([]),be=g([]),L=g(""),Ue=g(2),ze=g(0),Ce=g(0),H=g(0),ae=g(2),$e=g(new Map),j=g(!1),Q=g(!1),N=g(!1),l=g(!1),Z=g(!1),D=g(!1),me=g(!1),Ae=g(!1),oe=g(null),he=g(null),Te=g(null),Re=g(null),ye=g(new Date().getMonth()),Ee=g(new Date().getFullYear());function Ze(){j.value=!1,Q.value=!1,N.value=!1,l.value=!1}function $(s){s==="regions"?(j.value=!j.value,Q.value=N.value=l.value=!1):s==="ships"?(Q.value=!Q.value,j.value=N.value=l.value=!1):s==="guests"?(N.value=!N.value,j.value=Q.value=l.value=!1):s==="dates"&&(l.value=!l.value,j.value=Q.value=N.value=!1)}function n(s){s==="regions"?(j.value=!1,Q.value=!0,N.value=l.value=!1):s==="ships"?(Q.value=!1,N.value=!0,j.value=l.value=!1):s==="guests"?(N.value=!1,l.value=!0,j.value=Q.value=!1):s==="dates"&&Ze()}function _(s){const t=se.value.indexOf(s);t>=0?se.value.splice(t,1):se.value.push(s)}function U(s){const t=ue.value.indexOf(s);t>=0?ue.value.splice(t,1):ue.value.push(s)}function ee(){ae.value=Math.min(16,(ae.value||0)+1)}function Se(){ae.value=Math.max(1,(ae.value||1)-1)}M(()=>Es());const de=M(()=>`${["January","February","March","April","May","June","July","August","September","October","November","December"][ye.value]} ${Ee.value}`),Je=M(()=>{const s=new Date(Ee.value,ye.value,1),t=new Date(Ee.value,ye.value+1,0),o=new Date(s),r=new Date;o.setDate(o.getDate()-o.getDay());const u=[],y=new Date(t);y.setDate(y.getDate()+(6-t.getDay()));for(let w=new Date(o);w<=y;w.setDate(w.getDate()+1)){const x=w.getDay(),a=w.getMonth()===ye.value,b=a&&w>=r&&(x===1||x===5),P=it(w);u.push({key:w.getTime(),date:w.getDate(),fullDate:P,isCurrentMonth:a,isSelectable:b,isSelected:L.value===P,isMonday:x===1,isFriday:x===5})}return u});function We(s){let t=ye.value+s,o=Ee.value;t>11&&(t=0,o+=1),t<0&&(t=11,o-=1),ye.value=t,Ee.value=o}function mt(){We(1)}function et(){We(-1)}function os(s){s.isSelectable&&(L.value=s.fullDate)}const ns=M(()=>{if(se.value.length)return se.value[0];const s=S.value;return Array.isArray(s==null?void 0:s.destinations)&&s.destinations.length?s.destinations[0]:Rt}),Lt=M(()=>{var r,u,y;const s=S.value;if(!s)return[];const t=s.ships&&s.ships.length?s.ships:s.lodges||[],o=[];for(const w of t){const x=f.value[w]||[];let a=0,b=0;for(const X of x){const E=(((r=X==null?void 0:X.operators)==null?void 0:r.flatMap(te=>te.cabins||[]))||[]).reduce((te,Oe)=>{const xe=String(Oe).match(/\((\d+)\)/);return te+(xe?parseInt(xe[1],10):0)},0);a+=E,b+=E}const P=x.length,ge=P>0?a/P:0,ne=ge>=(s.totalGuests||0),le=Math.max(1,s.totalGuests||(s.adults||0)+(s.children||0)),J=x.find(X=>(X==null?void 0:X.date)===s.dateFrom)||x[0],ke=(((y=(u=J==null?void 0:J.operators)==null?void 0:u[0])==null?void 0:y.cabins)||[]).reduce((X,De)=>{const E=String(De).match(/\((\d+)\)/),te=E?parseInt(E[1],10):0;return X+(te>=le?1:0)},0);o.push({lodge:w,hasAvailability:ne,availableSlots:Math.floor(ge),totalSlots:P>0?Math.floor(b/P):0,image:"/src/images/komodo.jpg",availableCabinsCount:ke,dateFrom:s.dateFrom})}return o}),ls=M(()=>{const s=S.value;if(!s)return[];const t=s.ships&&s.ships.length?s.ships:s.lodges||[],o=s.dateFrom,r=Math.max(1,s.totalGuests||(s.adults||0)+(s.children||0)),u=[],y=new Set;for(const w of t){const x=f.value[w]||[],a=x.find(P=>(P==null?void 0:P.date)===o)||x[0],b=((a==null?void 0:a.operators)||[]).flatMap(P=>P.cabins||[]);for(const P of b){const ge=wt(P),ne=hs(P),le=typeof P=="string"?"":St(P);if(ne==null||ne>=r){const ce=(typeof P!="string"&&(P!=null&&P.id)?String(P.id).trim().toLowerCase():null)||`${Pe(w)}|${Ye(ge)}`;if(y.has(ce))continue;y.add(ce),u.push({ship:w,cabinName:ge,capacity:ne,date:o,image:le})}}}return u}),Ut=M(()=>ls.value.map(s=>({cabinName:s.cabinName,ship:s.ship,date:s.date,capacity:s.capacity,image:s.image||"/src/images/komodo.jpg"})));M(()=>{const s=S.value;return s?Math.max(1,s.totalGuests||(s.adults||0)+(s.children||0)):1});const tt=M(()=>{const s=I.value;if(!s)return null;if(s.detail)return console.log("[Results] Using attached detail:",s.detail),s.detail;const t=$e.value||new Map,o=s.shipName||s.operatorLabel||"",r=s.cabinName,u=`${Pe(o)}|${Ye(r)}`;console.log("[Results] Looking up detail for key:",u,"map size:",t.size);const y=t.get(u);if(y)return console.log("[Results] Found detail from map:",y),y;const w=s.raw;return w&&(w.description||w.price||w.capacity)?(console.log("[Results] Using raw detail data:",w),w):(console.log("[Results] No detail found for:",r,"ship:",o),null)}),is=M(()=>{const s=tt.value,t=I.value,o=(s==null?void 0:s.description)||(s==null?void 0:s.desc)||(t==null?void 0:t.description)||"",r=String(o).trim();return console.log("[Results] Description:",r||"(fallback)"),r||"If you are desperate for a vacation, bring your friends or family and step away from it all."}),yt=M(()=>{const s=tt.value,t=I.value;let o=null;if(s&&(o=typeof s.price=="number"?s.price:s.price_lock||s.price),o||(o=(t==null?void 0:t.price)||Ct(t)),console.log("[Results] Price raw value:",o),o==null)return"";const r=Dt(o,Ve);if(!r)return"";const u=xt(r.amount,r.currency);return console.log("[Results] Formatted price:",u),u}),zt=M(()=>{var o,r;const s=tt.value;return s!=null&&s.capacity?s.capacity:jt((o=I.value)==null?void 0:o.capacityText)||((r=I.value)==null?void 0:r.capacity)||""}),Vt=M(()=>{var x;const s=tt.value,t=I.value;if(!s&&!t)return[];const o=(s==null?void 0:s.api_name)||((x=t==null?void 0:t.raw)==null?void 0:x.api_name)||"",r=(s==null?void 0:s.capacity)||(t==null?void 0:t.capacityText)||"",u=`${o} ${r}`.toUpperCase(),y=[];(u.includes("PRIVATE BATHROOM")||u.includes("ENSUITE"))&&y.push("Private Bathroom"),(u.includes("PRIVATE BALCONY")||u.includes("BALCONY"))&&y.push("Private Balcony"),(u.includes("BATHUB")||u.includes("BATHTUB"))&&y.push("Bathtub"),(u.includes("SEA VIEW")||u.includes("SEAVIEW")||u.includes("OCEAN VIEW"))&&y.push("Sea View"),(u.includes("DOUBLE BED")||u.includes("KING BED")||u.includes("QUEEN BED"))&&y.push("Double Bed"),(u.includes("AC")||u.includes("AIR CON"))&&y.push("Air Conditioning");const w=s==null?void 0:s.facilities;if(w&&typeof w=="object"){const a={wifi:"Wi-Fi",starlink:"Starlink",jacuzzi:"Jacuzzi",indoor_jacuzzi:"Indoor Jacuzzi",outdoor_jacuzzi:"Outdoor Jacuzzi",indoor_lounge:"Indoor Lounge",outdoor_lounge:"Outdoor Lounge",sundeck:"Sundeck",seaview:"Sea View",balcony:"Balcony",private_bathroom:"Private Bathroom",shower:"Shower",bathtub:"Bathtub",outdoor_bathtub:"Outdoor Bathtub",king_bed:"King Bed",bar:"Bar",hammock:"Hammock",smart_tv:"Smart TV",ac:"Air Conditioning"};for(const[b,P]of Object.entries(a))w[b]&&!y.includes(P)&&y.push(P)}return y.length>0?y:["Private Cabin","Basic Amenities"]}),Jt=M(()=>{const s=S.value;return s?Array.isArray(s.destinations)&&s.destinations.length?s.destinations.join(", "):s.destination||"":""}),ft=M(()=>{const s=S.value;if(!s)return[];const t=s.ships&&s.ships.length?s.ships:s.lodges||[],o=s.shipSheets&&s.shipSheets.length?s.shipSheets:[],r=new Set,u=y=>{const w=Pe(String(y).replace(/normalized/gi,"").replace(/cruise schedule/gi,""));if(!w)return;r.add(w);const x=w.split(" ")[0];x&&r.add(x)};return t.forEach(u),o.forEach(u),Array.from(r)}),gt=M(()=>{const s=S.value,t=m.value;if(!s||!t||!Array.isArray(t.operators))return[];const o=ft.value,r=$e.value||new Map,u=new Map;for(const w of t.operators){const x=w.operator,a=w.cabins||[];for(const b of a){const P=_t(b);if(P!=null&&P<=0)continue;const ge=wt(b),ne=Kt(b),le=Ct(b),J=$t(b,x);if(o.length&&!Ht(J,o))continue;const ce=typeof b!="string"&&(b!=null&&b.id)?String(b.id).trim().toLowerCase():null,ke=Ye(ge),X=ce||`${Pe(J)}|${ke}`||`${Pe(x)}|${ke}`,De=r.get(`${Pe(J)}|${ke}`),E=Ct(De)||le,te=Kt(De)||ne,Oe=_t(De),xe=Oe??P,je=St(De)||St(b)||"/src/images/komodo.jpg",Zt=u.get(X),Os={key:X,operatorLabel:x,shipName:J,cabinName:ge,available:xe,availableText:xe!=null?`${xe} available`:"Available",price:E,capacityText:te,date:s.dateFrom,image:je,raw:b,detail:De};if(!Zt)u.set(X,Os);else{const Me={...Zt};Me.available==null&&xe!=null&&(Me.available=xe),!Me.price&&E&&(Me.price=E),!Me.capacityText&&te&&(Me.capacityText=te),Me.availableText=Me.available!=null?`${Me.available} available`:"Available",u.set(X,Me)}}}const y=Array.from(u.values());return y.sort((w,x)=>(w.operatorLabel||"").localeCompare(x.operatorLabel||"")||(w.cabinName||"").localeCompare(x.cabinName||"")),y}),rs=M(()=>{const s=S.value,t=m.value;if(!s||!t||!Array.isArray(t.operators)||ft.value.length===0)return!1;for(const r of t.operators){const u=r.operator,y=r.cabins||[];for(const w of y){const x=_t(w);if(x!=null&&x<=0)continue;const a=$t(w,u);if(!Ht(a,ft.value))return!0}}return!1}),bt=M(()=>{const s=h.value||{},t=jt(s.capacityText);return t||(s.available&&s.available>0?s.available*4:16)}),Fe=M(()=>{const s=A.value||[];if(!s.length)return{hasPrice:!1,total:0,formattedTotal:"",pricedCount:0,missingCount:0};let t="",o=0,r=0;for(const y of s){const w=Dt(y==null?void 0:y.price,t||Ve);if(!w||(t||(t=w.currency),t&&w.currency&&t!==w.currency))continue;const x=Number((y==null?void 0:y.guests)||2),a=Number(w.amount)*(Number.isFinite(x)?x:2);o+=a,r++}const u=r>0;return{hasPrice:u,total:o,formattedTotal:u?xt(o,t||Ve):"",pricedCount:r,missingCount:s.length-r}});function Be(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""}function st(s){return s?Xt(s,2):""}function us(s){if(!s)return"";const t=s.trim().split(/[\s(]+/)[0];return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}function ht(s){console.debug("Previous image for lodge:",s)}function kt(s){console.debug("Next image for lodge:",s)}async function ds(){Le.value=!0;try{const s=await as();if(_e.value=(s.operators||[]).map(t=>{var u,y;const o=((u=t.operator)==null?void 0:u.trim())||"",r=((y=t.sourceSheet)==null?void 0:y.trim())||o;return{id:`${o}__${r}`,label:o,sheet:r}}).filter(t=>t.label&&t.sheet),!ue.value.length&&be.value.length){const t=[];for(const o of be.value){const r=_e.value.find(u=>u.label===o.label&&u.sheet===(o.sheet||u.sheet));r&&t.push(r.id)}ue.value=t}}catch(s){console.warn("Failed to load operators:",s),_e.value=Ie.map(t=>({id:t.id||`${t.label||""}__${t.sheet||""}`,label:t.label,sheet:t.sheet||t.label}))}finally{Le.value=!1}}async function cs(){try{const s=await Ot("Detail Cabin");console.log("[Results] Detail Cabin API response:",s);const t=new Map;((s==null?void 0:s.operators)||[]).forEach(o=>{var u;const r=o.operator||"";console.log("[Results] Processing operator:",r,"cabins:",(u=o.cabins)==null?void 0:u.length),(o.cabins||[]).forEach(y=>{const w=wt(y),x=$t(y,r),a=`${Pe(x)}|${Ye(w)}`;console.log("[Results] Storing detail cabin:",a,y),a.trim()&&t.set(a,y)})}),$e.value=t,console.log("[Results] Detail cabin map size:",t.size,"entries:",Array.from(t.keys()))}catch(s){console.warn("Failed to load Detail Cabin sheet",s)}}async function at(){if(S.value){i.value=!0,p.value="",f.value={},C.value=[],m.value=null;try{const s=S.value,t=Is(s.dateFrom,s.dateTo),o=s.ships&&s.ships.length?s.ships:s.lodges||[],r=s.shipSheets&&s.shipSheets.length?s.shipSheets:o;let u=null;const y=()=>(u||(u=Ot("Cruise Schedule - Normalized").catch(()=>null)),u),w={};await Promise.all(r.map(async(b,P)=>{const ge=o[P]||b;let ne=[];try{const le=await Ot(b);Array.isArray(le==null?void 0:le.allCabins)&&(ne=le.allCabins.map(J=>String(J).split(" (")[0].trim()))}catch{}if(ne.length===0)try{const le=await y();if(le){const J=Pe(ge),ce=(le.operators||[]).find(ke=>Pe(ke.operator)===J);ce&&Array.isArray(ce.cabins)&&(ne=ce.cabins.map(ke=>String(ke).split(" (")[0].trim()))}}catch{}w[b]=Array.from(new Set(ne.map(Ye)))}));const x=await Promise.all(r.map(async(b,P)=>{var De;const ge=o[P]||b,ne=w[b]||[],le=t.map(E=>ut(E,b).catch(()=>null)),J=await Promise.all(le),ce=J.map((E,te)=>!E||!E.operators||E.operators.length===0?te:-1).filter(E=>E>=0);let ke=[];if(ce.length){const E=ce.map(Oe=>ut(t[Oe],"Cruise Schedule - Normalized").catch(()=>null));ke=await Promise.all(E)}const X=[];for(let E=0;E<t.length;E++){const te=J[E]&&J[E].operators&&J[E].operators.length?J[E]:ce.includes(E)?ke[ce.indexOf(E)]:null;if(te){const Oe=((De=te.operators)==null?void 0:De.flatMap(je=>je.cabins||[]))||[],xe=ne.length?Oe.filter(je=>ne.includes(Ye(je))):Oe;X.push({...te,operators:[{operator:ge,total:xe.length,cabins:xe}]})}}return[ge,X]})),a={};for(const[b,P]of x)a[b]=P;if(f.value=a,C.value=Object.values(a).flat(),s!=null&&s.dateFrom)try{let b=await ut(s.dateFrom).catch(()=>null);(!b||!b.operators||b.operators.length===0)&&(b=await ut(s.dateFrom,"Cruise Schedule - Normalized").catch(()=>null)),m.value=b||null}catch(b){console.debug("[Results] global start availability error",b)}C.value.length===0&&(p.value="No availability data found for the selected dates and ships.")}catch(s){p.value=`Failed to check availability: ${s.message}`,console.error("Availability check error:",s)}finally{i.value=!1}}}const vs=()=>at(),ps=()=>at(),ms=()=>{G.value=!G.value};function ys(){try{const s=_e.value.filter(u=>ue.value.includes(u.id)),t=s.map(u=>u.label),o=s.map(u=>u.sheet),r={region:Rt,destination:se.value[0]||"",destinations:se.value.slice(),ships:t,shipSheets:o,ship:t[0]||"",lodges:t.slice(),dateFrom:L.value,dateTo:L.value?Xt(L.value,3):"",adults:ae.value,children:0,age3_9:0,age0_2:0,totalGuests:ae.value,timestamp:Date.now()};if(be.value=s.map(u=>({label:u.label,sheet:u.sheet})),localStorage.setItem("komodo_search_criteria",JSON.stringify(r)),S.value=r,L.value){const u=new Date(L.value);ye.value=u.getMonth(),Ee.value=u.getFullYear()}at()}catch(s){console.error("Failed to apply sidebar changes",s),alert("Failed to apply changes")}}function fs(s){return[oe.value,he.value,Te.value,Re.value].some(o=>o&&(o===s||o.contains(s)))}function Yt(s){fs(s.target)||Ze()}document.addEventListener("click",Yt),ss(()=>{document.removeEventListener("click",Yt)}),vt(async()=>{try{await cs();const s=localStorage.getItem("komodo_search_criteria");if(s){S.value=JSON.parse(s);const t=S.value||{};se.value=Array.isArray(t.destinations)?t.destinations.slice():t.destination?[t.destination]:[];const o=Array.isArray(t.ships)?t.ships:[],r=Array.isArray(t.shipSheets)?t.shipSheets:[];if(be.value=o.map((u,y)=>({label:u,sheet:r[y]||""})),L.value=t.dateFrom||"",Ue.value=t.adults??Ue.value,ze.value=t.children??ze.value,Ce.value=t.age3_9??Ce.value,H.value=t.age0_2??H.value,ae.value=t.totalGuests??Ue.value+ze.value+Ce.value+H.value,L.value){const u=new Date(L.value);ye.value=u.getMonth(),Ee.value=u.getFullYear()}}await at()}catch(s){console.error("Failed to load search criteria:",s),p.value="Failed to load search criteria"}await ds()});function wt(s){return s?typeof s=="string"?s.split(" (")[0].trim():(s.cabin_name||s.name||s["cabin name"]||s.api_name||"").toString().split(" (")[0].trim():""}function _t(s){return!s||typeof s=="string"?null:typeof s.available=="number"?s.available:null}function Kt(s){if(!s)return"";if(typeof s=="string"){const t=s.match(/\(([^)]+)\)$/);return t?t[1]:""}return s.capacity||s.capacity_lock||""}function Ct(s){return!s||typeof s=="string"?"":s.price_lock||s.price||""}function $t(s,t){return s&&typeof s!="string"&&s.shipname?s.shipname:(t||"").replace(/\([^)]*\)/g,"").trim()}function gs(s){if(!s)return"";try{const t=String(s),o=Wt(t);return o?`https://lh3.googleusercontent.com/d/${o}=w1600`:t}catch{return s}}function Wt(s){if(!s)return"";const t=String(s).match(/\/d\/([^/?#]+)/),o=String(s).match(/[?&]id=([^&]+)/);return t&&t[1]||o&&o[1]||""}function bs(s){const t=[],o=String(s||""),r=Wt(o);return o&&t.push(o),r&&(t.push(`https://lh3.googleusercontent.com/d/${r}=w1600`),t.push(`https://drive.google.com/uc?export=view&id=${r}`),t.push(`https://drive.google.com/uc?export=download&id=${r}`),t.push(`https://drive.google.com/thumbnail?id=${r}&sz=w1600`)),Array.from(new Set(t))}function ot(s,t){const o=s==null?void 0:s.target;if(!o)return;const r=parseInt(o.getAttribute("data-try")||"0",10),u=bs(t);r<u.length-1?(o.setAttribute("data-try",String(r+1)),o.src=u[r+1]):o.src="/src/images/komodo.jpg"}function St(s){if(!s||typeof s=="string")return"";const t=[];s.image_main&&t.push(s.image_main),Array.isArray(s.images)&&t.push(...s.images);for(let r=1;r<=10;r++){const u=`image_${r}`;s[u]&&t.push(s[u])}const o=t.find(r=>!!r&&String(r).trim().length>0)||"";return o?gs(o):""}function hs(s){if(typeof s=="string"){const o=s.match(/\(([^)]+)\)$/);if(o&&o[1]){const r=(o[1].match(/\d+/g)||[]).map(u=>parseInt(u,10));if(r.length)return Math.max(...r)}return null}const t=(s.capacity||s.capacity_lock||"").toString();if(t){const o=(t.match(/\d+/g)||[]).map(r=>parseInt(r,10));if(o.length)return Math.max(...o)}return null}function Pe(s){return s?String(s).replace(/\([^)]*\)/g," ").toLowerCase().replace(/[^a-z0-9]+/g," ").trim().replace(/\s+/g," "):""}function Ye(s){if(!s)return"";let t=String(s);t=t.replace(/\([^)]*\)$/,"").trim();const o=t.split(/[-–—]/);return t=o[o.length-1],t.toLowerCase().replace(/[^a-z0-9]+/g," ").trim().replace(/\s+/g," ")}function Ht(s,t){const o=Pe(s);return t.some(r=>o.includes(r)||r.includes(o))}function jt(s){if(!s)return null;const o=String(s).match(/\d+/g);if(!o||o.length===0)return null;const r=o.map(u=>parseInt(u,10));return Math.max(...r)}function Dt(s,t=Ve){var a,b;if(s==null)return null;if(typeof s=="number"&&!Number.isNaN(s))return{amount:s,currency:t};const o=String(s).trim();if(!o)return null;const r=o.match(/([^\d]*)([\d.,\s]+)/);if(!r)return null;let u=((a=r[1])==null?void 0:a.replace(/from/gi,"").trim())||t,y=(b=r[2])==null?void 0:b.trim();if(!y)return null;y=y.replace(/[\s,]/g,""),(y.match(/\./g)||[]).length>1&&(y=y.replace(/\./g,""));const x=parseFloat(y);return Number.isNaN(x)?null:{amount:x,currency:u}}function xt(s,t=Ve){return Number.isFinite(s)?`${t||Ve} ${Math.round(s).toLocaleString("en-US")}`:""}function ks(s){if(!(s!=null&&s.price))return"";const t=Dt(s.price,Ve);if(!t)return"";const o=Number((s==null?void 0:s.guests)||2),r=t.amount*(Number.isFinite(o)?o:2);return xt(r,t.currency)}function ws(s){console.log("[Results] Opening cabin modal for:",s),I.value=s,O.value=!0,At()}function Nt(){O.value=!1,I.value=null,B.value=1,Tt()}function _s(){var t;const s=((t=I.value)==null?void 0:t.available)||1;B.value<s&&B.value++}function Cs(){B.value>1&&B.value--}function $s(){K.value=!0,At()}function Ss(){K.value=!1,Tt()}function nt(){Y.value=!1,h.value=null,q.value=2,Tt()}function Ds(){const s=bt.value;q.value=Math.min(s,q.value+1)}function xs(){q.value=Math.max(1,q.value-1)}function Ns(){h.value&&(As(h.value,q.value),nt())}function He(s){return A.value.some(t=>t.cabin===s.cabinName&&t.ship===s.shipName&&t.date===s.date)}function Qt(s){var t;He(s)?Ts(s):(h.value=s,q.value=((t=S.value)==null?void 0:t.totalGuests)||2,Y.value=!0,At())}function As(s,t=2){try{const o="komodo_itinerary",r=JSON.parse(localStorage.getItem(o)||"[]");if(r.some(w=>w.cabin===s.cabinName&&w.ship===s.shipName&&w.date===s.date))return;const y={operator:s.operatorLabel,ship:s.shipName,cabin:s.cabinName,date:s.date,price:s.price||null,capacity:s.capacityText||null,guests:t,qty:1,addedAt:Date.now()};r.push(y),localStorage.setItem(o,JSON.stringify(r)),lt()}catch(o){console.error("Failed to add to itinerary",o)}}function Ts(s){try{const t="komodo_itinerary",r=JSON.parse(localStorage.getItem(t)||"[]").filter(u=>!(u.cabin===s.cabinName&&u.ship===s.shipName&&u.date===s.date));localStorage.setItem(t,JSON.stringify(r)),lt()}catch(t){console.error("Failed to remove from itinerary",t)}}function lt(){try{const t=JSON.parse(localStorage.getItem("komodo_itinerary")||"[]");A.value=Array.isArray(t)?t:[]}catch{A.value=[]}}function Ps(s){try{const t="komodo_itinerary",o=JSON.parse(localStorage.getItem(t)||"[]");o.splice(s,1),localStorage.setItem(t,JSON.stringify(o)),lt()}catch(t){console.error("Failed to remove item",t)}}const fe={count:0,bodyOverflow:"",htmlOverflow:"",bodyPadding:"",htmlPadding:""};function At(){const s=document.body,t=document.documentElement;if(!(!s||!t)){if(fe.count===0){const o=window.innerWidth-t.clientWidth;if(fe.bodyOverflow=s.style.overflow,fe.htmlOverflow=t.style.overflow,fe.bodyPadding=s.style.paddingRight,fe.htmlPadding=t.style.paddingRight,o>0){const r=`${o}px`;s.style.paddingRight=r,t.style.paddingRight=r}s.style.overflow="hidden",t.style.overflow="hidden"}fe.count++}}function Tt(){const s=document.body,t=document.documentElement;!s||!t||fe.count!==0&&(fe.count--,!(fe.count>0)&&(s.style.overflow=fe.bodyOverflow,t.style.overflow=fe.htmlOverflow,s.style.paddingRight=fe.bodyPadding,t.style.paddingRight=fe.htmlPadding))}const T=g({title:"",firstName:"",lastName:"",phoneCountry:"+62",phoneNumber:"",country:"",email:"",confirmEmail:"",userType:"",notes:"",subscribeNews:!1,consentData:!1});async function Ms(){if(!T.value.firstName||!T.value.lastName){alert("Please enter your first and last name");return}if(!T.value.email||T.value.email!==T.value.confirmEmail){alert("Please ensure email addresses match");return}if(!T.value.consentData){alert("Please consent to data collection to proceed");return}if(!A.value.length){alert("Please add at least one cabin to your itinerary");return}let s=0;const t=[];for(const o of A.value){const r=yo(o.price),u=Number(o.guests||2),y=r*u;s+=y,t.push({name:`${o.ship} - ${o.cabin}`,quantity:u,price:r,category:"Cruise Cabin"})}s<=0&&(s=1e6,t.push({name:"Komodo Cruise Booking",quantity:1,price:s,category:"Cruise Booking"})),pe.value=!0;try{const r=`Komodo Cruise Booking: ${A.value.map(y=>`${y.ship} - ${y.cabin}`).join(", ")}`,u=await po({amount:s,payerEmail:T.value.email,description:r,customerName:`${T.value.title?T.value.title+" ":""}${T.value.firstName} ${T.value.lastName}`,customerPhone:T.value.phoneCountry+T.value.phoneNumber,items:t});if(localStorage.setItem("komodo_last_enquiry",JSON.stringify({form:T.value,itinerary:A.value,invoiceId:u.invoiceId,invoiceUrl:u.invoiceUrl,amount:s,createdAt:new Date().toISOString()})),u.invoiceUrl)mo(u.invoiceUrl);else throw new Error("No invoice URL received")}catch(o){console.error("Failed to create payment:",o),alert(`Failed to process payment: ${o.message}. Please try again.`)}finally{pe.value=!1}}function Is(s,t){if(!s||!t)return s?[s]:[];const o=new Date(s),r=new Date(t),u=[];for(let y=new Date(o);y<=r;y.setDate(y.getDate()+1))u.push(it(y));return u}function Xt(s,t){const o=new Date(s);return o.setDate(o.getDate()+t),it(o)}function it(s){return s.toISOString().split("T")[0]}function Es(){return it(new Date)}return lt(),(s,t)=>{var o,r,u,y,w,x;return c(),v("div",fo,[e("div",go,[e("div",bo,[e("div",ho,[t[58]||(t[58]=e("h2",{class:"results-title"},"Your Search Results",-1)),i.value?(c(),v("div",ko,[...t[40]||(t[40]=[e("p",null,"Loading availability data...",-1)])])):p.value?(c(),v("div",wo,[e("p",_o,d(p.value),1),e("button",{onClick:ps,class:"btn-primary"},"Try Again")])):(c(),v("div",Co,[e("div",$o,[gt.value.length?(c(),v("div",So,[...t[41]||(t[41]=[e("p",null,[e("strong",null,"Your preferred travel dates are available!"),F(" We have a team of Singita Journey Designers who are ready to plan your trip. Simply select the results that suit your preferences best and submit your enquiry. ")],-1),e("p",{class:"results-note-muted"},[e("span",{class:"semibold"},"Note:"),F(" These results indicate availability and do not guarantee a booking.")],-1)])])):G.value?R("",!0):(c(),v("div",Do,[...t[42]||(t[42]=[e("p",null,[e("strong",null,"Your preferred dates are unfortunately not available, but there is availability at other Singita lodges or on alternate dates.")],-1),e("p",null,"We have a team of Singita Journey Designers who are ready to plan your trip. Simply select the results that suit your preferences best and submit your enquiry.",-1),e("p",{class:"results-note-muted"},[e("span",{class:"semibold"},"Note:"),F(" These results indicate availability and do not guarantee a booking.")],-1)])]))]),gt.value.length?(c(),v("div",xo,[(c(!0),v(W,null,ie(gt.value,a=>(c(),v("div",{class:"cabin-card",key:a.key},[e("div",No,[e("img",{src:a.image,alt:a.cabinName,referrerpolicy:"no-referrer",decoding:"async",loading:"lazy",onError:b=>ot(b,a.image)},null,40,Ao),e("button",{class:"gallery-nav gallery-prev",onClick:b=>ht(a.cabinName),"aria-label":"Previous image"},"‹",8,To),e("button",{class:"gallery-nav gallery-next",onClick:b=>kt(a.cabinName),"aria-label":"Next image"},"›",8,Po)]),e("div",Mo,[e("div",Io,[e("div",Eo,[e("h3",Oo,d(a.cabinName),1),e("div",Ro,[e("p",Fo,d(us(a.operatorLabel)),1),e("button",{class:"cabin-details-btn",onClick:b=>ws(a)},[t[43]||(t[43]=F(" Cabin details ",-1)),e("img",{src:Vi,alt:"arrow",class:"arrow-icon"})],8,Bo)])])]),t[45]||(t[45]=e("div",{class:"cabin-divider"},null,-1)),t[46]||(t[46]=e("div",{class:"availability-box"},[e("h4",{class:"availability-title"},"Great news, we have availability!"),e("p",{class:"availability-text"},"Select the result that best suits you from the list below and it will be added to the itinerary summary on the right.")],-1)),e("div",qo,[e("div",Go,[e("p",Lo,[t[44]||(t[44]=e("strong",null,"Start from",-1)),F(" "+d(a.price||"Rp3,650,000")+" per adult, per night",1)]),e("p",Uo,d(a.available||1)+" available",1)]),e("div",zo,[e("button",{class:V(["btn-add-to-itinerary",{"in-itinerary":He(a)}]),onClick:b=>Qt(a)},[e("span",Jo,d(He(a)?"Remove":"Add to itinerary"),1),e("span",Yo,[He(a)?(c(),v("span",Ko,"✕")):(c(),v("span",Wo))])],10,Vo)])])])]))),128))])):G.value&&rs.value?(c(),v("div",Ho,[...t[47]||(t[47]=[e("h4",null,"Alternative options are available",-1),e("p",null,"There are cabins available on other ships for your selected date. Adjust your ship selection to view them.",-1)])])):G.value&&Ut.value.length?(c(),v("div",jo,[(c(!0),v(W,null,ie(Ut.value,a=>(c(),v("div",{class:"lodge-card",key:a.ship+":"+a.cabinName},[e("div",Qo,[e("div",Xo,[e("img",{src:a.image,alt:a.cabinName,referrerpolicy:"no-referrer",decoding:"async",loading:"lazy",onError:b=>ot(b,a.image)},null,40,Zo),e("button",{class:"gallery-prev",onClick:b=>ht(a.cabinName)},"<",8,en),e("button",{class:"gallery-next",onClick:b=>kt(a.cabinName)},">",8,tn)])]),e("div",sn,[e("div",an,[e("div",null,[e("h3",on,d(a.cabinName),1),e("p",nn,d(Jt.value),1)]),t[48]||(t[48]=e("button",{class:"lodge-details-btn"},"Cabin details >",-1))]),t[51]||(t[51]=e("div",{class:"availability-success"},[e("h4",null,"Great news, we have availability!"),e("p",null,"Select the result that best suits you from the list below and it will be added to the itinerary summary on the right.")],-1)),e("div",ln,[t[49]||(t[49]=e("div",{class:"suites-header",style:{display:"flex","align-items":"center","justify-content":"space-between"}},[e("h5",{style:{margin:"0"}},"Suite"),e("span",{class:"price-from"},"1 available")],-1)),e("p",rn,"Date: "+d(Be(a.date)),1),t[50]||(t[50]=e("div",{class:"action-buttons",style:{display:"flex",gap:".5rem","align-items":"center"}},[e("button",{class:"btn-details"},"Room & Rate Details >"),e("button",{class:"btn-add-itinerary"},"Add to itinerary")],-1))])])]))),128))])):G.value&&Lt.value.length?(c(),v("div",un,[(c(!0),v(W,null,ie(Lt.value,a=>(c(),v("div",{class:"lodge-card",key:a.lodge},[e("div",dn,[e("div",cn,[e("img",{src:a.image,alt:a.lodge,referrerpolicy:"no-referrer",decoding:"async",loading:"lazy",onError:b=>ot(b,a.image)},null,40,vn),e("button",{class:"gallery-prev",onClick:b=>ht(a.lodge)},"<",8,pn),e("button",{class:"gallery-next",onClick:b=>kt(a.lodge)},">",8,mn)])]),e("div",yn,[e("div",fn,[e("div",null,[e("h3",gn,d(a.lodge),1),e("p",bn,d(Jt.value),1)]),t[52]||(t[52]=e("button",{class:"lodge-details-btn"},"Cabin details >",-1))]),a.hasAvailability?(c(),v("div",hn,[...t[53]||(t[53]=[e("h4",null,"Great news, we have availability!",-1),e("p",null,"Select the result that best suits you from the list below and it will be added to the itinerary summary on the right.",-1)])])):(c(),v("div",kn,[...t[54]||(t[54]=[e("h4",null,"Alternative options are available",-1),e("p",null,"Unfortunately, there isn't availability for your selected dates. However, the following alternate options may suit your requirements.",-1)])])),e("div",wn,[e("div",_n,[t[55]||(t[55]=e("h5",{style:{margin:"0"}},"Suite",-1)),e("span",Cn,d(a.availableCabinsCount)+" available",1)]),e("p",$n,"Date: "+d(Be(a.dateFrom)),1),t[56]||(t[56]=e("div",{class:"action-buttons",style:{display:"flex",gap:".5rem","align-items":"center"}},[e("button",{class:"btn-details"},"Room & Rate Details >"),e("button",{class:"btn-add-itinerary"},"Add to itinerary")],-1))])])]))),128))])):G.value?(c(),v("div",Sn,[t[57]||(t[57]=e("p",null,"No alternative options found for your criteria.",-1)),e("button",{onClick:vs,class:"btn-primary"},"Search Again")])):R("",!0)]))]),e("div",Dn,[e("div",xn,[t[73]||(t[73]=e("h3",{class:"section-title-sidebar"},"Check Availability",-1)),e("div",{class:"list dropdown",ref_key:"destDropdown",ref:oe},[t[60]||(t[60]=e("div",{class:"list-heading"},"Destinations",-1)),e("button",{type:"button",class:V(["select-summary",j.value||D.value?"is-filled":""]),onMouseenter:t[0]||(t[0]=a=>D.value=!0),onMouseleave:t[1]||(t[1]=a=>D.value=!1),onClick:t[2]||(t[2]=ve(a=>$("regions"),["stop"])),"aria-expanded":j.value?"true":"false"},[e("span",null,"Destinations: "+d(se.value.length),1),e("span",An,[e("img",{src:j.value?ct:dt,alt:"","aria-hidden":"true",class:"caret-icon"},null,8,Tn)])],42,Nn),j.value?(c(),v("div",{key:0,class:"dropdown-panel",onClick:t[6]||(t[6]=ve(()=>{},["stop"]))},[e("div",{class:"dropdown-group-title"},d(Rt)),(c(),v(W,null,ie(re,a=>e("div",{class:"list-row",key:a,onClick:b=>_(a)},[e("div",Mn,d(a),1),z(e("input",{class:"check",type:"checkbox",value:a,"onUpdate:modelValue":t[3]||(t[3]=b=>se.value=b),onClick:t[4]||(t[4]=ve(()=>{},["stop"]))},null,8,In),[[Ke,se.value]])],8,Pn)),64)),e("div",{class:"dropdown-footer",onClick:t[5]||(t[5]=a=>n("regions"))},[...t[59]||(t[59]=[e("span",null,"Next",-1),e("span",{style:{"font-size":"1.1rem"}},"›",-1)])])])):R("",!0)],512),e("div",{class:"list dropdown",ref_key:"shipsDropdown",ref:he},[t[62]||(t[62]=e("div",{class:"list-heading"},"Ships",-1)),e("button",{type:"button",class:V(["select-summary",Q.value||Z.value?"is-filled":""]),onMouseenter:t[7]||(t[7]=a=>Z.value=!0),onMouseleave:t[8]||(t[8]=a=>Z.value=!1),onClick:t[9]||(t[9]=ve(a=>$("ships"),["stop"])),"aria-expanded":Q.value?"true":"false"},[e("span",null,"Ships: "+d(ue.value.length),1),e("span",On,[e("img",{src:Q.value?ct:dt,alt:"","aria-hidden":"true",class:"caret-icon"},null,8,Rn)])],42,En),Q.value?(c(),v("div",{key:0,class:"dropdown-panel",onClick:t[13]||(t[13]=ve(()=>{},["stop"]))},[e("div",Fn,d(ns.value),1),Le.value?(c(),v("div",Bn,"Loading ships...")):(c(),v(W,{key:1},[(c(!0),v(W,null,ie(_e.value,a=>(c(),v("div",{class:"list-row",key:a.id,onClick:b=>U(a.id)},[e("div",Gn,d(a.label),1),z(e("input",{class:"check",type:"checkbox",value:a.id,"onUpdate:modelValue":t[10]||(t[10]=b=>ue.value=b),onClick:t[11]||(t[11]=ve(()=>{},["stop"]))},null,8,Ln),[[Ke,ue.value]])],8,qn))),128)),_e.value.length===0?(c(),v("div",Un,"No ships found from API.")):R("",!0)],64)),e("div",{class:"dropdown-footer",onClick:t[12]||(t[12]=a=>n("ships"))},[...t[61]||(t[61]=[e("span",null,"Next",-1),e("span",{style:{"font-size":"1.1rem"}},"›",-1)])])])):R("",!0)],512),e("div",{class:"list dropdown",ref_key:"guestsDropdown",ref:Te},[t[66]||(t[66]=e("div",{class:"list-heading"},"Guests",-1)),e("button",{type:"button",class:V(["select-summary",N.value||me.value?"is-filled":""]),onMouseenter:t[14]||(t[14]=a=>me.value=!0),onMouseleave:t[15]||(t[15]=a=>me.value=!1),onClick:t[16]||(t[16]=ve(a=>$("guests"),["stop"])),"aria-expanded":N.value?"true":"false"},[e("span",null,d(ae.value)+" Guests",1),e("span",Vn,[e("img",{src:N.value?ct:dt,alt:"","aria-hidden":"true",class:"caret-icon"},null,8,Jn)])],42,zn),N.value?(c(),v("div",{key:0,class:"dropdown-panel",onClick:t[18]||(t[18]=ve(()=>{},["stop"]))},[t[65]||(t[65]=e("div",{class:"dropdown-group-title"},"Guests",-1)),e("div",Yn,[t[63]||(t[63]=e("div",{class:"simple-guests-label"},"Guests",-1)),e("div",Kn,[e("button",{type:"button",class:"btn-icon",onClick:Se},"−"),e("span",Wn,d(ae.value),1),e("button",{type:"button",class:"btn-icon",onClick:ee},"+")])]),e("div",{class:"dropdown-footer",onClick:t[17]||(t[17]=a=>n("guests"))},[...t[64]||(t[64]=[e("span",null,"Next",-1),e("span",{style:{"font-size":"1.1rem"}},"›",-1)])])])):R("",!0)],512),e("div",{class:"list dropdown",ref_key:"datesDropdown",ref:Re},[t[71]||(t[71]=e("div",{class:"list-heading"},"Dates",-1)),e("button",{type:"button",class:V(["select-summary",l.value||Ae.value?"is-filled":""]),onMouseenter:t[19]||(t[19]=a=>Ae.value=!0),onMouseleave:t[20]||(t[20]=a=>Ae.value=!1),onClick:t[21]||(t[21]=ve(a=>$("dates"),["stop"])),"aria-expanded":l.value?"true":"false"},[e("span",null,d(L.value?`${L.value} → ${st(L.value)}`:"Select date"),1),e("span",jn,[e("img",{src:l.value?ct:dt,alt:"","aria-hidden":"true",class:"caret-icon"},null,8,Qn)])],42,Hn),l.value?(c(),v("div",{key:0,class:"dropdown-panel",onClick:t[23]||(t[23]=ve(()=>{},["stop"]))},[t[70]||(t[70]=e("div",{class:"dropdown-group-title"},"Dates",-1)),e("div",Xn,[t[67]||(t[67]=e("label",{class:"date-label"},"Date Range:",-1)),e("input",{type:"text",disabled:"",class:"input date-input",value:L.value?`${Be(L.value)} → ${Be(st(L.value))}`:""},null,8,Zn)]),e("div",el,[e("div",tl,[e("button",{class:"calendar-nav",onClick:et,type:"button"},"‹"),e("h4",sl,d(de.value),1),e("button",{class:"calendar-nav",onClick:mt,type:"button"},"›")]),e("div",al,[t[68]||(t[68]=Ge('<div class="calendar-weekdays"><div class="weekday">Su</div><div class="weekday">Mo</div><div class="weekday">Tu</div><div class="weekday">We</div><div class="weekday">Th</div><div class="weekday">Fr</div><div class="weekday">Sa</div></div>',1)),e("div",ol,[(c(!0),v(W,null,ie(Je.value,a=>(c(),v("button",{key:a.key,class:V(["calendar-day",{"other-month":!a.isCurrentMonth,selected:a.isSelected,disabled:!a.isSelectable,monday:a.isMonday,friday:a.isFriday}]),disabled:!a.isSelectable,onClick:b=>os(a),type:"button"},d(a.date),11,nl))),128))])])]),e("div",{class:"dropdown-footer",onClick:t[22]||(t[22]=a=>n("dates"))},[...t[69]||(t[69]=[e("span",null,"Next",-1),e("span",{style:{"font-size":"1.1rem"}},"›",-1)])])])):R("",!0)],512),e("div",ll,[t[72]||(t[72]=e("div",{class:"muted",style:{"font-size":".9rem"}},"My dates are flexible, show alternatives",-1)),e("button",{"aria-pressed":G.value?"true":"false",onClick:ms,title:"toggle alternatives",style:Ls({width:"32px",height:"32px",borderRadius:"9999px",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:G.value?"#efcab6":"#e5e7eb",color:G.value?"#7a3e2d":"#374151"})},d(G.value?"✓":"•"),13,il)]),e("div",{class:"sidebar-actions"},[e("button",{class:"btn-primary",onClick:ys},"Apply")])]),e("div",rl,[t[76]||(t[76]=e("h3",{class:"itinerary-title"},"Your Itinerary",-1)),t[77]||(t[77]=e("p",{class:"itinerary-description"},"This is a summary of the accommodation you have selected. After submitting your booking request, a Singita Journey Designer will make contact to book and confirm your trip.",-1)),t[78]||(t[78]=e("div",{class:"itinerary-divider"},null,-1)),A.value.length===0?(c(),v("div",ul," You haven't selected any options yet. ")):(c(),v("ul",dl,[(c(!0),v(W,null,ie(A.value,(a,b)=>(c(),v("li",{key:a.addedAt,class:"itinerary-item"},[e("div",cl,[e("h4",vl,d(a.ship),1),e("button",{class:"itinerary-remove-btn",onClick:P=>Ps(b),"aria-label":"Remove item"},[...t[74]||(t[74]=[e("span",{class:"remove-icon"},"✕",-1)])],8,pl)]),e("div",ml,d(a.cabin),1),e("div",yl,d(a.guests||2)+" Guest"+d((a.guests||2)>1?"s":""),1),e("div",fl,"from "+d(a.price||"ZAR 49 205")+" per adult, per night",1),e("div",gl,d(Be(a.date))+" → "+d(Be(st(a.date))),1)]))),128))])),Fe.value.hasPrice?(c(),v("div",bl,[e("div",hl,[t[75]||(t[75]=e("span",{class:"itinerary-total-label"},"Estimated total (per night, all guests)",-1)),e("span",kl,d(Fe.value.formattedTotal),1)]),e("p",wl," Includes "+d(Fe.value.pricedCount)+" of "+d(A.value.length)+" selections. Final amounts are confirmed by our Journey Designers. ",1),Fe.value.missingCount?(c(),v("p",_l,d(Fe.value.missingCount)+" selection"+d(Fe.value.missingCount>1?"s":"")+" doesn't have live pricing and is excluded from this estimate. ",1)):R("",!0)])):A.value.length?(c(),v("p",Cl," Pricing for the selected cabins will be confirmed by our Journey Designers. ")):R("",!0),A.value.length?(c(),v("button",{key:4,class:"btn-send-enquiry",onClick:$s},"Send Availability Enquiry")):R("",!0),t[79]||(t[79]=e("a",{href:"#",class:"link-speak-with-us"},"Speak with us ›",-1))])])])]),O.value&&I.value?(c(),v("div",{key:0,class:"modal-overlay",onClick:Nt},[e("div",{class:"modal-content",onClick:t[26]||(t[26]=ve(()=>{},["stop"]))},[e("button",{class:"modal-close",onClick:Nt},"✕"),t[86]||(t[86]=e("div",{class:"modal-header"},[e("span",{class:"modal-title"},"Room Information")],-1)),e("div",$l,[e("div",Sl,[e("img",{src:I.value.image,alt:I.value.cabinName,referrerpolicy:"no-referrer",class:"modal-cabin-image",onError:t[24]||(t[24]=a=>ot(a,I.value.image))},null,40,Dl),t[80]||(t[80]=e("button",{class:"modal-gallery-nav modal-gallery-prev","aria-label":"Previous"},"‹",-1)),t[81]||(t[81]=e("button",{class:"modal-gallery-nav modal-gallery-next","aria-label":"Next"},"›",-1))]),e("div",xl,[e("h2",Nl,d(I.value.cabinName),1),e("div",Al,[e("span",Tl,"Sleeps "+d(zt.value||"2"),1),e("span",Pl,"Max "+d(zt.value||"2")+" guests",1),e("span",Ml,d(((o=I.value)==null?void 0:o.operatorLabel)||((r=I.value)==null?void 0:r.shipName)||"Private cabin"),1)]),e("div",Il,[e("p",null,d(is.value),1)]),e("div",El,[Vt.value.length?(c(!0),v(W,{key:0},ie(Vt.value,a=>(c(),v("div",{class:"amenity-item",key:a},[e("span",null,d(a),1)]))),128)):(c(),v("div",Ol,"Basic amenities included."))]),e("div",Rl,[t[83]||(t[83]=e("h3",{class:"modal-rate-title"},"Direct Rate",-1)),t[84]||(t[84]=e("p",{class:"modal-rate-description"},"Beat those winter blues with a 2 night stay and enjoy 10% off accommodation.",-1)),e("div",Fl,[e("div",Bl,[e("div",ql,[t[82]||(t[82]=e("label",{class:"quantity-label"},"Number of Cabins",-1)),e("div",Gl,[e("button",{class:"quantity-btn",onClick:Cs,disabled:B.value<=1},"−",8,Ll),e("span",Ul,d(B.value),1),e("button",{class:"quantity-btn",onClick:_s,disabled:B.value>=(((u=I.value)==null?void 0:u.available)||1)},"+",8,zl)]),e("span",Vl,d(((y=I.value)==null?void 0:y.available)||0)+" available",1)])]),e("div",Jl,[e("span",Yl,d(yt.value||"Price on request"),1),yt.value?(c(),v("span",Kl,"/Night")):R("",!0),yt.value?(c(),v("span",Wl,"Excluding taxes and fees.")):R("",!0)])]),t[85]||(t[85]=e("div",{class:"modal-actions"},[e("button",{class:"modal-link-btn"},"Read more ›"),e("button",{class:"modal-link-btn"},"View price breakdown ›")],-1)),e("button",{class:"modal-book-btn",onClick:t[25]||(t[25]=a=>{Qt(I.value),Nt()})},d(He(I.value)?"Remove from itinerary":"Book Now"),1)])])])])])):R("",!0),Y.value?(c(),v("div",{key:1,class:"guest-modal-overlay",onClick:nt},[e("div",{class:"guest-modal-content",onClick:t[27]||(t[27]=ve(()=>{},["stop"]))},[e("button",{class:"guest-modal-close",onClick:nt},"✕"),t[89]||(t[89]=e("div",{class:"guest-modal-header"},[e("h3",{class:"guest-modal-title"},"Number of Guests")],-1)),e("div",Hl,[t[88]||(t[88]=e("p",{class:"guest-modal-description"},"Please indicate how many guests will be accommodated:",-1)),e("div",jl,[e("div",Ql,[t[87]||(t[87]=e("div",{class:"guest-counter-label"},"Number of Cabins",-1)),e("div",Xl,[e("button",{type:"button",class:"guest-counter-btn",onClick:xs,disabled:q.value<=1},"−",8,Zl),e("span",ei,d(q.value),1),e("button",{type:"button",class:"guest-counter-btn",onClick:Ds,disabled:q.value>=bt.value},"+",8,ti)])]),e("div",si,[F(d(((w=h.value)==null?void 0:w.availableText)||"1 available")+" ",1),(x=h.value)!=null&&x.capacityText?(c(),v("span",ai," • Max "+d(bt.value)+" guests",1)):R("",!0)])]),e("div",{class:"guest-modal-actions"},[e("button",{class:"btn-cancel-guest",onClick:nt},"Cancel"),e("button",{class:"btn-submit-guest",onClick:Ns},"Add to Itinerary")])])])])):R("",!0),K.value?(c(),v("div",oi,[e("div",ni,[e("div",{class:"enquiry-modal-header"},[t[90]||(t[90]=e("h2",{class:"enquiry-modal-title"},"Plan your Trip",-1)),e("button",{class:"enquiry-modal-close",onClick:Ss},"Close ✕")]),e("div",li,[e("div",ii,[t[108]||(t[108]=e("p",{class:"enquiry-intro"},"Please complete the form below and one of our Journey Designers will contact you shortly to plan your trip.",-1)),e("form",{class:"enquiry-form",onSubmit:ve(Ms,["prevent"])},[e("div",ri,[e("div",ui,[t[92]||(t[92]=e("label",{class:"form-label"},"Title",-1)),z(e("select",{class:"form-control","onUpdate:modelValue":t[28]||(t[28]=a=>T.value.title=a)},[...t[91]||(t[91]=[Ge('<option value="">Select</option><option value="Mr">Mr</option><option value="Mrs">Mrs</option><option value="Ms">Ms</option><option value="Dr">Dr</option>',5)])],512),[[rt,T.value.title]])]),e("div",di,[t[93]||(t[93]=e("label",{class:"form-label"},"First Name",-1)),z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[29]||(t[29]=a=>T.value.firstName=a),required:""},null,512),[[qe,T.value.firstName]])]),e("div",ci,[t[94]||(t[94]=e("label",{class:"form-label"},"Last Name",-1)),z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[30]||(t[30]=a=>T.value.lastName=a),required:""},null,512),[[qe,T.value.lastName]])])]),e("div",vi,[e("div",pi,[t[96]||(t[96]=e("label",{class:"form-label"},"Contact Number",-1)),e("div",mi,[z(e("select",{class:"phone-country","onUpdate:modelValue":t[31]||(t[31]=a=>T.value.phoneCountry=a)},[...t[95]||(t[95]=[Ge('<option value="+62">🇮🇩 +62</option><option value="+1">🇺🇸 +1</option><option value="+44">🇬🇧 +44</option><option value="+61">🇦🇺 +61</option><option value="+65">🇸🇬 +65</option><option value="+60">🇲🇾 +60</option>',6)])],512),[[rt,T.value.phoneCountry]]),z(e("input",{type:"tel",class:"form-control","onUpdate:modelValue":t[32]||(t[32]=a=>T.value.phoneNumber=a),placeholder:"812345678"},null,512),[[qe,T.value.phoneNumber]])])]),e("div",yi,[t[98]||(t[98]=e("label",{class:"form-label"},"Country",-1)),z(e("select",{class:"form-control","onUpdate:modelValue":t[33]||(t[33]=a=>T.value.country=a)},[...t[97]||(t[97]=[Ge('<option value="">Select Country</option><option value="Indonesia">Indonesia</option><option value="United States">United States</option><option value="United Kingdom">United Kingdom</option><option value="Australia">Australia</option><option value="Singapore">Singapore</option><option value="Malaysia">Malaysia</option>',7)])],512),[[rt,T.value.country]])])]),e("div",fi,[e("div",gi,[t[99]||(t[99]=e("label",{class:"form-label"},"Email",-1)),z(e("input",{type:"email",class:"form-control","onUpdate:modelValue":t[34]||(t[34]=a=>T.value.email=a),required:""},null,512),[[qe,T.value.email]])]),e("div",bi,[t[100]||(t[100]=e("label",{class:"form-label"},"Confirm Email Address",-1)),z(e("input",{type:"email",class:"form-control","onUpdate:modelValue":t[35]||(t[35]=a=>T.value.confirmEmail=a),required:""},null,512),[[qe,T.value.confirmEmail]])])]),e("div",hi,[t[102]||(t[102]=e("label",{class:"form-label"},"I am a:",-1)),z(e("select",{class:"form-control","onUpdate:modelValue":t[36]||(t[36]=a=>T.value.userType=a)},[...t[101]||(t[101]=[e("option",{value:""},"Select",-1),e("option",{value:"guest"},"Guest",-1),e("option",{value:"agent"},"Travel Agent",-1)])],512),[[rt,T.value.userType]])]),e("div",ki,[t[103]||(t[103]=e("label",{class:"form-label"},"Is there anything else you'd like to let us know?",-1)),z(e("textarea",{class:"form-control form-textarea",rows:"4","onUpdate:modelValue":t[37]||(t[37]=a=>T.value.notes=a)},null,512),[[qe,T.value.notes]])]),e("div",wi,[e("label",_i,[z(e("input",{type:"checkbox","onUpdate:modelValue":t[38]||(t[38]=a=>T.value.subscribeNews=a)},null,512),[[Ke,T.value.subscribeNews]]),t[104]||(t[104]=e("span",null,"Sign up to receive news and blog posts from Singita",-1))]),e("label",Ci,[z(e("input",{type:"checkbox","onUpdate:modelValue":t[39]||(t[39]=a=>T.value.consentData=a),required:""},null,512),[[Ke,T.value.consentData]]),t[105]||(t[105]=e("span",null,"I consent to my submitted data being collected and stored",-1))])]),t[106]||(t[106]=e("p",{class:"form-note"},[e("strong",null,"PLEASE NOTE:"),F(" These results indicate availability and do not guarantee a booking. One of our Journey Designers will contact you shortly to plan your trip. ")],-1)),e("button",{type:"submit",class:"btn-submit-enquiry",disabled:pe.value},d(pe.value?"PROCESSING...":"PROCEED TO PAYMENT"),9,$i),t[107]||(t[107]=e("p",{class:"form-recaptcha"},"This form is protected by reCAPTCHA Enterprise and the Google Privacy Policy and Terms of Service apply.",-1))],32)]),e("div",Si,[t[112]||(t[112]=e("h3",{class:"summary-title"},"Your Itinerary",-1)),t[113]||(t[113]=e("p",{class:"summary-description"},"This is a summary of the accommodation you've selected. One of our Singita Journey Designers will contact you shortly to plan your trip.",-1)),e("div",Di,[(c(!0),v(W,null,ie(A.value,(a,b)=>(c(),v("div",{key:b,class:"summary-item"},[e("div",xi,[e("h4",Ni,d(a.ship),1)]),e("div",Ai,[e("p",Ti,d(a.cabin),1),e("p",Pi,d(a.guests||2)+" Guest"+d((a.guests||2)>1?"s":""),1),e("p",Mi,d(Be(a.date))+" → "+d(Be(st(a.date))),1)]),a.price?(c(),v("div",Ii,[e("div",Ei,[t[109]||(t[109]=e("span",{class:"pricing-label"},"Price per cabin",-1)),e("span",Oi,d(a.price),1)]),e("div",Ri,[e("span",Fi,"× "+d(a.guests||2)+" guest"+d((a.guests||2)>1?"s":""),1),e("span",Bi,d(ks(a)),1)])])):R("",!0)]))),128))]),Fe.value.hasPrice?(c(),v("div",qi,[t[111]||(t[111]=e("div",{class:"enquiry-total-divider"},null,-1)),e("div",Gi,[e("div",Li,[t[110]||(t[110]=e("span",{class:"enquiry-total-label"},"Total Price",-1)),e("span",Ui,d(Fe.value.formattedTotal),1)])])])):A.value.length?(c(),v("p",zi," Pricing for the selected cabins will be confirmed by our Journey Designers. ")):R("",!0)])])])])):R("",!0)])}}},Yi={class:"plan-wrap plan-page"},Ki={class:"plan-content"},Wi={class:"steps",role:"tablist","aria-label":"Plan steps"},Hi=["disabled"],ji=["disabled"],Qi=["disabled"],Xi=["disabled"],Zi={key:0},er={class:"list"},tr={class:"list-text"},sr=["value","aria-label"],ar={key:1},or={class:"list"},nr={class:"list-text"},lr=["value","aria-label"],ir={key:2},rr={class:"date-input-section"},ur=["min"],dr={class:"custom-calendar"},cr={class:"calendar-header"},vr={class:"calendar-title"},pr={class:"calendar-grid"},mr={class:"calendar-days"},yr=["disabled","onClick"],fr={key:3},gr={class:"counters"},br={class:"counter-row"},hr={class:"counter-ctrls"},kr={class:"count"},wr={class:"counter-row"},_r={class:"counter-ctrls"},Cr={class:"count"},$r={class:"counter-row"},Sr={class:"counter-ctrls"},Dr={class:"count"},xr={class:"counter-row"},Nr={class:"counter-ctrls"},Ar={class:"count"},Tr={key:4},Pr={class:"mt-4"},Mr={class:"mt-4"},Ir={class:"mt-4",style:{"text-align":"right"}},Er={class:"bottom-bar"},Or={class:"nav-inner",style:{display:"flex","align-items":"center","justify-content":"space-between"}},Rr={key:1},Fr="Nusa Tenggara Timur",Br={__name:"Plan",setup(k){const i=g(1),p=["Pulau Komodo","Labuan Bajo"],S=[],f=g(""),C=g(""),m=g(""),A=g(""),h=g(2),O=g(0),Y=g(0),K=g(0),I=g(new Date().getMonth()),B=g(new Date().getFullYear()),q=["Destinations","Ships","Dates","Guests","Submit"],pe=M(()=>q[i.value-2]||""),G=M(()=>i.value<5?q[i.value-1]+" ›":"Submit ›"),re=M(()=>new Date().toISOString().split("T")[0]),Ie=M(()=>`${["January","February","March","April","May","June","July","August","September","October","November","December"][I.value]} ${B.value}`),_e=M(()=>{const N=new Date(B.value,I.value,1),l=new Date(B.value,I.value+1,0),Z=new Date(N),D=new Date;Z.setDate(Z.getDate()-Z.getDay());const me=[],Ae=new Date(l);Ae.setDate(Ae.getDate()+(6-l.getDay()));for(let oe=new Date(Z);oe<=Ae;oe.setDate(oe.getDate()+1)){const he=oe.getDay(),Te=oe.getMonth()===I.value,Re=Te&&oe>=D&&(he===1||he===5),ye=oe.toISOString().split("T")[0];me.push({key:oe.getTime(),date:oe.getDate(),fullDate:ye,isCurrentMonth:Te,isSelectable:Re,isSelected:m.value===ye,isMonday:he===1,isFriday:he===5})}return me}),Le=M(()=>!!f.value),se=M(()=>!!f.value&&!!C.value),ue=M(()=>!!f.value&&!!C.value&&!!m.value);Ft(f,()=>{C.value=""});function be(N){i.value=N}function L(){if(i.value===1&&!f.value)return ae("Please select a destination first.");if(i.value===2&&!C.value)return ae("Please select a ship first.");if(i.value===3&&!m.value)return ae("Please select a start date first.");i.value<5?i.value++:ze()}function Ue(){i.value>1&&i.value--}function ze(){const N={region:Fr,destination:f.value,ship:C.value,lodges:C.value?[C.value]:[],dateFrom:m.value,dateTo:A.value,adults:h.value,children:O.value,age3_9:Y.value,age0_2:K.value,totalGuests:h.value+O.value+Y.value+K.value,timestamp:Date.now()};localStorage.setItem("komodo_search_criteria",JSON.stringify(N)),window.location.href="/results"}function Ce(N){N==="adults"?h.value++:N==="children"?O.value++:N==="age3_9"?Y.value++:N==="age0_2"&&K.value++}function H(N){N==="adults"&&h.value>0?h.value--:N==="children"&&O.value>0?O.value--:N==="age3_9"&&Y.value>0?Y.value--:N==="age0_2"&&K.value>0&&K.value--}function ae(N){alert(N)}function $e(){I.value===0?(I.value=11,B.value--):I.value--}function j(){I.value===11?(I.value=0,B.value++):I.value++}function Q(N){if(N.isSelectable){m.value=N.fullDate;const l=new Date(N.fullDate);l.setDate(l.getDate()+3),A.value=l.toISOString().split("T")[0]}}return(N,l)=>{const Z=Xe("router-link");return c(),v("section",Yi,[e("div",Ki,[e("div",Wi,[e("button",{class:V(["step",{"step-active":i.value===1}]),onClick:l[0]||(l[0]=D=>be(1))},"Step 1",2),e("button",{class:V(["step",{"step-active":i.value===2}]),onClick:l[1]||(l[1]=D=>be(2)),disabled:!Le.value},"Step 2",10,Hi),e("button",{class:V(["step",{"step-active":i.value===3}]),onClick:l[2]||(l[2]=D=>be(3)),disabled:!se.value},"Step 3",10,ji),e("button",{class:V(["step",{"step-active":i.value===4}]),onClick:l[3]||(l[3]=D=>be(4)),disabled:!ue.value},"Step 4",10,Qi),e("button",{class:V(["step",{"step-active":i.value===5}]),onClick:l[4]||(l[4]=D=>be(5)),disabled:!ue.value},"Step 5",10,Xi)]),i.value===1?(c(),v("div",Zi,[l[17]||(l[17]=e("h3",{class:"step-title"},"Destinations",-1)),l[18]||(l[18]=e("p",{class:"results-note"},[F("Region: "),e("span",{class:"semibold"},"Nusa Tenggara Timur")],-1)),l[19]||(l[19]=e("p",{class:"results-note"},"Select a destination you're interested in:",-1)),e("div",er,[l[16]||(l[16]=e("div",{class:"list-heading"},"Nusa Tenggara Timur",-1)),(c(),v(W,null,ie(p,D=>e("div",{class:"list-row",key:D},[e("div",tr,d(D),1),z(e("input",{class:"radio",type:"radio",name:"destination",value:D,"onUpdate:modelValue":l[5]||(l[5]=me=>f.value=me),"aria-label":`Destination ${D}`},null,8,sr),[[es,f.value]])])),64))])])):i.value===2?(c(),v("div",ar,[l[21]||(l[21]=e("h3",{class:"step-title"},"Ships",-1)),l[22]||(l[22]=e("p",{class:"results-note"},"Please select a ship:",-1)),e("div",or,[l[20]||(l[20]=e("div",{class:"list-heading"},"Available Ships",-1)),(c(),v(W,null,ie(S,D=>e("div",{class:"list-row",key:D},[e("div",nr,d(D),1),z(e("input",{class:"radio",type:"radio",name:"ship",value:D,"onUpdate:modelValue":l[6]||(l[6]=me=>C.value=me),"aria-label":`Ship ${D}`},null,8,lr),[[es,C.value]])])),64))])])):i.value===3?(c(),v("div",ir,[l[25]||(l[25]=e("h3",{class:"step-title"},"Dates",-1)),l[26]||(l[26]=e("p",{class:"results-note"},"Select the start date for your trip:",-1)),l[27]||(l[27]=e("p",{class:"results-note text-sm"},"Trips start only on Mondays and Fridays.",-1)),e("div",rr,[l[23]||(l[23]=e("label",{class:"date-label"},"Start Date:",-1)),z(e("input",{type:"date",class:"input date-input","onUpdate:modelValue":l[7]||(l[7]=D=>m.value=D),min:re.value},null,8,ur),[[qe,m.value]])]),e("div",dr,[e("div",cr,[e("button",{class:"calendar-nav",onClick:$e,type:"button"},"‹"),e("h4",vr,d(Ie.value),1),e("button",{class:"calendar-nav",onClick:j,type:"button"},"›")]),e("div",pr,[l[24]||(l[24]=Ge('<div class="calendar-weekdays"><div class="weekday">Su</div><div class="weekday">Mo</div><div class="weekday">Tu</div><div class="weekday">We</div><div class="weekday">Th</div><div class="weekday">Fr</div><div class="weekday">Sa</div></div>',1)),e("div",mr,[(c(!0),v(W,null,ie(_e.value,D=>(c(),v("button",{key:D.key,class:V(["calendar-day",{"other-month":!D.isCurrentMonth,selected:D.isSelected,disabled:!D.isSelectable,monday:D.isMonday,friday:D.isFriday}]),disabled:!D.isSelectable,onClick:me=>Q(D),type:"button"},d(D.date),11,yr))),128))])])])])):i.value===4?(c(),v("div",fr,[l[32]||(l[32]=e("h3",{class:"step-title"},"Guests",-1)),l[33]||(l[33]=e("p",{class:"results-note"},"Please indicate how many adults will need to be accommodated.",-1)),l[34]||(l[34]=e("p",{class:"results-note"},"If your booking includes children, please enquire directly on the next step.",-1)),l[35]||(l[35]=e("p",{class:"results-note"},"View our child policy for each lodge here.",-1)),e("div",gr,[e("div",br,[l[28]||(l[28]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Adults"),e("div",{class:"muted text-sm"},"Ages 17+")],-1)),e("div",hr,[e("button",{type:"button",class:"btn-icon",onClick:l[8]||(l[8]=D=>H("adults"))},"−"),e("span",kr,d(h.value),1),e("button",{type:"button",class:"btn-icon",onClick:l[9]||(l[9]=D=>Ce("adults"))},"+")])]),e("div",wr,[l[29]||(l[29]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Children"),e("div",{class:"muted text-sm"},"Ages 10 - 16")],-1)),e("div",_r,[e("button",{type:"button",class:"btn-icon",onClick:l[10]||(l[10]=D=>H("children"))},"−"),e("span",Cr,d(O.value),1),e("button",{type:"button",class:"btn-icon",onClick:l[11]||(l[11]=D=>Ce("children"))},"+")])]),e("div",$r,[l[30]||(l[30]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Ages 3 - 9")],-1)),e("div",Sr,[e("button",{type:"button",class:"btn-icon",onClick:l[12]||(l[12]=D=>H("age3_9"))},"−"),e("span",Dr,d(Y.value),1),e("button",{type:"button",class:"btn-icon",onClick:l[13]||(l[13]=D=>Ce("age3_9"))},"+")])]),e("div",xr,[l[31]||(l[31]=e("div",{class:"counter-text"},[e("div",{class:"semibold"},"Ages 0 - 2")],-1)),e("div",Nr,[e("button",{type:"button",class:"btn-icon",onClick:l[14]||(l[14]=D=>H("age0_2"))},"−"),e("span",Ar,d(K.value),1),e("button",{type:"button",class:"btn-icon",onClick:l[15]||(l[15]=D=>Ce("age0_2"))},"+")])])])])):(c(),v("div",Tr,[l[39]||(l[39]=e("h3",{class:"step-title"},"Check Availability",-1)),l[40]||(l[40]=e("p",{class:"results-note"}," To see if we have availability for your preferred criteria, please click the button below. ",-1)),e("div",Pr,[we(Z,{class:"btn-primary",to:"/results"},{default:Ne(()=>[...l[36]||(l[36]=[F("Check now",-1)])]),_:1})]),l[41]||(l[41]=e("div",{class:"section-divider",style:{margin:"1.5rem 0"}},null,-1)),l[42]||(l[42]=e("h4",{class:"section-title"},"Speak with a Komodo Cruises Travel Advisor",-1)),l[43]||(l[43]=e("p",{class:"results-note"}," Need some help to plan your trip? Enquire below to contact one of our Komodo Cruises Travel Advisors. ",-1)),e("div",Mr,[we(Z,{class:"btn-primary",to:"/results"},{default:Ne(()=>[...l[37]||(l[37]=[F("Enquire now",-1)])]),_:1})]),e("div",Ir,[we(Z,{to:"/",class:"nav-link"},{default:Ne(()=>[...l[38]||(l[38]=[F("Back to Search",-1)])]),_:1})])])),e("div",Er,[e("div",Or,[i.value>1?(c(),v("button",{key:0,class:"link-muted",onClick:Ue},"‹ "+d(pe.value),1)):(c(),v("span",Rr)),e("button",{class:"btn-primary",onClick:L},d(G.value),1)])])])])}}},qr={class:"payment-success-page"},Gr={class:"success-container"},Lr={class:"success-content"},Ur={class:"booking-card"},zr={class:"booking-header"},Vr={class:"booking-id"},Jr={class:"value"},Yr={class:"booking-details"},Kr={class:"detail-section"},Wr={class:"detail-grid"},Hr={class:"detail-item"},jr={class:"value"},Qr={class:"detail-item"},Xr={class:"value"},Zr={class:"detail-item"},eu={class:"value"},tu={class:"detail-section"},su={class:"detail-grid"},au={class:"detail-item"},ou={class:"value"},nu={class:"detail-item"},lu={class:"value"},iu={class:"detail-item"},ru={class:"value"},uu={class:"detail-item"},du={class:"value"},cu={class:"detail-item"},vu={class:"value"},pu={class:"detail-section payment-section"},mu={class:"payment-breakdown"},yu={class:"payment-row"},fu={class:"payment-row total"},gu={class:"total-amount"},bu={class:"email-notice"},hu={class:"email-content"},ku={key:0},wu={key:1},_u={key:2},Cu={class:"action-buttons"},$u={__name:"PaymentSuccess",setup(k){const i=g("sending"),p=Us({bookingId:"KC2025001",customerName:"Guest",email:"guest@email.com",phone:"-",shipName:"Komodo Cruise",cabinName:"-",itinerary:"-",travelDate:"To be confirmed",guests:2,pricePerCabin:0,totalAmount:0}),S=C=>C?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(C):"Rp 0",f=async()=>{try{i.value="sending",(await(await fetch("https://komodo-cruises-production-0c52.up.railway.app/api/send-confirmation-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerName:p.customerName,customerEmail:p.email,customerPhone:p.phone,bookingId:p.bookingId,shipName:p.shipName,cabinName:p.cabinName,itinerary:p.itinerary,travelDate:p.travelDate,guests:p.guests,pricePerCabin:p.pricePerCabin,totalAmount:p.totalAmount})})).json()).success?i.value="sent":i.value="failed"}catch(C){console.error("Failed to send email:",C),i.value="failed"}};return vt(async()=>{try{const C=localStorage.getItem("komodo_last_enquiry");if(C){const m=JSON.parse(C);if(m.form&&(p.customerName=`${m.form.title||""} ${m.form.firstName||""} ${m.form.lastName||""}`.trim()||"Guest",p.email=m.form.email||"guest@email.com",p.phone=m.form.phone||"-"),m.itinerary&&m.itinerary.length>0){const A=m.itinerary[0];p.shipName=A.ship||"Komodo Cruise",p.cabinName=A.cabin||"-",p.itinerary=A.itinerary||"-",p.travelDate=A.date||"To be confirmed",p.guests=A.guests||2,p.pricePerCabin=A.pricePerCabin||0}p.totalAmount=m.amount||0,p.bookingId=m.invoiceId?`KC${Date.now().toString().slice(-8)}`:"KC2025001"}localStorage.removeItem("komodo_itinerary"),p.email&&p.email!=="guest@email.com"?await f():i.value="sent"}catch(C){console.error("Error loading booking data:",C),i.value="failed"}}),(C,m)=>{const A=Xe("router-link");return c(),v("div",qr,[e("div",Gr,[m[26]||(m[26]=Ge('<div class="success-animation" data-v-398585a2><div class="checkmark-circle" data-v-398585a2><svg class="checkmark" viewBox="0 0 52 52" data-v-398585a2><circle class="checkmark-circle-bg" cx="26" cy="26" r="25" fill="none" data-v-398585a2></circle><path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" data-v-398585a2></path></svg></div></div>',1)),e("div",Lr,[m[22]||(m[22]=e("h1",{class:"success-title"},"Thank You for Your Purchase!",-1)),m[23]||(m[23]=e("p",{class:"success-subtitle"},"Your payment has been successfully processed",-1)),e("div",Ur,[e("div",zr,[m[1]||(m[1]=e("div",{class:"booking-badge"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})]),e("span",null,"Booking Confirmed")],-1)),e("div",Vr,[m[0]||(m[0]=e("span",{class:"label"},"Booking ID",-1)),e("span",Jr,"#"+d(p.bookingId),1)])]),e("div",Yr,[e("div",Kr,[m[5]||(m[5]=e("h3",{class:"section-title"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})]),F(" Guest Information ")],-1)),e("div",Wr,[e("div",Hr,[m[2]||(m[2]=e("span",{class:"label"},"Name",-1)),e("span",jr,d(p.customerName),1)]),e("div",Qr,[m[3]||(m[3]=e("span",{class:"label"},"Email",-1)),e("span",Xr,d(p.email),1)]),e("div",Zr,[m[4]||(m[4]=e("span",{class:"label"},"Phone",-1)),e("span",eu,d(p.phone),1)])])]),e("div",tu,[m[11]||(m[11]=e("h3",{class:"section-title"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"})]),F(" Trip Details ")],-1)),e("div",su,[e("div",au,[m[6]||(m[6]=e("span",{class:"label"},"Ship",-1)),e("span",ou,d(p.shipName),1)]),e("div",nu,[m[7]||(m[7]=e("span",{class:"label"},"Cabin Type",-1)),e("span",lu,d(p.cabinName),1)]),e("div",iu,[m[8]||(m[8]=e("span",{class:"label"},"Itinerary",-1)),e("span",ru,d(p.itinerary),1)]),e("div",uu,[m[9]||(m[9]=e("span",{class:"label"},"Travel Date",-1)),e("span",du,d(p.travelDate),1)]),e("div",cu,[m[10]||(m[10]=e("span",{class:"label"},"Guests",-1)),e("span",vu,d(p.guests)+" Person(s)",1)])])]),e("div",pu,[m[14]||(m[14]=e("h3",{class:"section-title"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),e("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]),F(" Payment Summary ")],-1)),e("div",mu,[e("div",yu,[e("span",null,d(p.cabinName)+" × "+d(p.guests),1),e("span",null,d(S(p.pricePerCabin))+" × "+d(p.guests),1)]),m[13]||(m[13]=e("div",{class:"payment-divider"},null,-1)),e("div",fu,[m[12]||(m[12]=e("span",null,"Total Paid",-1)),e("span",gu,d(S(p.totalAmount)),1)])]),m[15]||(m[15]=e("div",{class:"payment-status"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})]),e("span",null,"Payment Successful")],-1))])])]),e("div",bu,[m[19]||(m[19]=e("div",{class:"email-icon"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),e("polyline",{points:"22,6 12,13 2,6"})])],-1)),e("div",hu,[m[17]||(m[17]=e("h4",null,"Check Your Email",-1)),e("p",null,[m[16]||(m[16]=F("A detailed receipt and booking confirmation has been sent to ",-1)),e("strong",null,d(p.email),1)]),m[18]||(m[18]=e("p",{class:"email-hint"},"Don't forget to check your spam folder if you don't see it within a few minutes.",-1))]),e("div",{class:V(["email-status",i.value])},[i.value==="sending"?(c(),v("span",ku,"Sending...")):i.value==="sent"?(c(),v("span",wu,"✓ Email Sent")):i.value==="failed"?(c(),v("span",_u,"⚠ Will retry")):R("",!0)],2)]),m[24]||(m[24]=Ge('<div class="whats-next" data-v-398585a2><h3 data-v-398585a2>What Happens Next?</h3><div class="next-steps" data-v-398585a2><div class="step" data-v-398585a2><div class="step-number" data-v-398585a2>1</div><div class="step-content" data-v-398585a2><strong data-v-398585a2>Email Confirmation</strong><p data-v-398585a2>Check your inbox for your booking receipt and trip details</p></div></div><div class="step" data-v-398585a2><div class="step-number" data-v-398585a2>2</div><div class="step-content" data-v-398585a2><strong data-v-398585a2>Journey Designer Contact</strong><p data-v-398585a2>Our team will reach out within 24 hours to finalize your itinerary</p></div></div><div class="step" data-v-398585a2><div class="step-number" data-v-398585a2>3</div><div class="step-content" data-v-398585a2><strong data-v-398585a2>Prepare for Adventure</strong><p data-v-398585a2>Get your travel documents ready and pack for an unforgettable trip!</p></div></div></div></div>',1)),e("div",Cu,[we(A,{to:"/",class:"btn-primary"},{default:Ne(()=>[...m[20]||(m[20]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e("polyline",{points:"9 22 9 12 15 12 15 22"})],-1),F(" Back to Home ",-1)])]),_:1}),we(A,{to:"/plan",class:"btn-secondary"},{default:Ne(()=>[...m[21]||(m[21]=[F(" Explore More Trips ",-1)])]),_:1})]),m[25]||(m[25]=e("div",{class:"support-info"},[e("p",null,"Need help? Contact our support team at"),e("a",{href:"mailto:support@komodocruises.com"},"support@komodocruises.com")],-1))])])])}}},Su=pt($u,[["__scopeId","data-v-398585a2"]]),Du={},xu={class:"payment-result-page"},Nu={class:"payment-result-container"},Au={class:"result-actions"};function Tu(k,i){const p=Xe("router-link");return c(),v("div",xu,[e("div",Nu,[i[2]||(i[2]=Ge('<div class="result-icon failed" data-v-690b1a80><svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-690b1a80><circle cx="12" cy="12" r="10" data-v-690b1a80></circle><line x1="15" y1="9" x2="9" y2="15" data-v-690b1a80></line><line x1="9" y1="9" x2="15" y2="15" data-v-690b1a80></line></svg></div><h1 class="result-title" data-v-690b1a80>Payment Failed</h1><p class="result-message" data-v-690b1a80> We&#39;re sorry, but your payment could not be processed. </p><div class="result-details" data-v-690b1a80><p data-v-690b1a80>This could be due to:</p><ul data-v-690b1a80><li data-v-690b1a80>Insufficient funds</li><li data-v-690b1a80>Card declined by issuer</li><li data-v-690b1a80>Payment session expired</li><li data-v-690b1a80>Technical issues</li></ul><p data-v-690b1a80>Please try again or contact our support team for assistance.</p></div>',4)),e("div",Au,[we(p,{to:"/results",class:"btn-secondary"},{default:Ne(()=>[...i[0]||(i[0]=[F("Try Again",-1)])]),_:1}),we(p,{to:"/",class:"btn-primary"},{default:Ne(()=>[...i[1]||(i[1]=[F("Back to Home",-1)])]),_:1})])])])}const Pu=pt(Du,[["render",Tu],["__scopeId","data-v-690b1a80"]]),Mu=zs({history:Vs(),routes:[{path:"/",component:co},{path:"/plan",component:Br,meta:{planHeader:!0}},{path:"/results",component:Ji},{path:"/payment-success",component:Su},{path:"/payment-failed",component:Pu}]});Js(na).use(Mu).mount("#app");
